<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Softora | Actieve Opdrachten — Software</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Oswald:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #f8f7f4;
            --bg-secondary: #ffffff;
            --bg-tertiary: #efeee9;
            --accent: #1a1a2e;
            --accent-light: #2d2d5e;
            --accent-color: #4a5fd7;
            --accent-color-light: #5b6ee0;
            --accent-color-glow: rgba(74, 95, 215, 0.2);
            --text-primary: #1a1a2e;
            --text-secondary: #6b6b7b;
            --text-tertiary: #a0a0b0;
            --border: rgba(0, 0, 0, 0.07);
            --green: #27ae60;
            --green-glow: rgba(39, 174, 96, 0.1);
            --yellow: #e67e22;
            --yellow-glow: rgba(230, 126, 34, 0.08);
            --red: #e74c3c;

            --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            cursor: none;
        }

        h1, h2, h3, h4 {
            font-family: 'Oswald', sans-serif;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.02em;
            line-height: 1;
        }

        .noise-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            opacity: 0.015;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }

        .cursor {
            width: 24px;
            height: 24px;
            border: 2px solid var(--accent);
            border-radius: 50%;
            position: fixed;
            pointer-events: none;
            z-index: 10000;
            transition: transform 0.1s var(--ease-out-expo), background 0.2s ease, width 0.3s var(--ease-out-expo), height 0.3s var(--ease-out-expo);
            transform: translate(-50%, -50%);
            mix-blend-mode: difference;
        }

        .cursor.hover {
            width: 80px;
            height: 80px;
            background: var(--accent);
            border-color: transparent;
        }

        .cursor-dot {
            width: 6px;
            height: 6px;
            background: var(--accent);
            border-radius: 50%;
            position: fixed;
            pointer-events: none;
            z-index: 10001;
            transform: translate(-50%, -50%);
        }

        /* Layout */
        .dashboard-layout {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border);
            padding: 2.5rem 0;
            display: flex;
            flex-direction: column;
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            z-index: 100;
            box-shadow: 4px 0 30px rgba(0,0,0,0.03);
        }

        .sidebar-logo {
            font-family: 'Oswald', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            text-decoration: none;
            padding: 0 2rem;
            margin-bottom: 3rem;
            display: block;
        }

        .sidebar-logo span { color: var(--accent-color); }
        .sidebar-nav { flex: 1; }
        .sidebar-section { margin-bottom: 2rem; }

        .sidebar-section-label {
            font-family: 'Oswald', sans-serif;
            font-size: 0.7rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            color: var(--text-tertiary);
            padding: 0 2rem;
            margin-bottom: 0.8rem;
        }

        .sidebar-link {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.8rem 2rem;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 400;
            transition: all 0.2s;
            cursor: none;
            position: relative;
        }

        .sidebar-link::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 3px;
            height: 100%;
            background: var(--accent-color);
            opacity: 0;
            transition: opacity 0.2s;
        }

        .sidebar-link:hover { color: var(--text-primary); background: rgba(0,0,0,0.02); }

        .sidebar-link.active {
            color: var(--accent-color);
            background: rgba(74, 95, 215, 0.04);
            font-weight: 500;
        }

        .sidebar-link.active::before { opacity: 1; }

        .sidebar-link svg { width: 18px; height: 18px; opacity: 0.4; flex-shrink: 0; }
        .sidebar-link.active svg, .sidebar-link:hover svg { opacity: 0.8; }

        .sidebar-link .count-badge {
            margin-left: auto;
            font-family: 'Oswald', sans-serif;
            font-size: 0.7rem;
            font-weight: 600;
            background: var(--accent-color);
            color: white;
            padding: 0.15rem 0.5rem;
            border-radius: 2px;
            letter-spacing: 0.05em;
        }

        .sidebar-footer { padding: 2rem; border-top: 1px solid var(--border); }

        .sidebar-user { display: flex; align-items: center; gap: 0.8rem; }

        .sidebar-avatar {
            width: 36px;
            height: 36px;
            background: var(--accent-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Oswald', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            color: white;
            flex-shrink: 0;
        }

        .sidebar-user-info { flex: 1; min-width: 0; }
        .sidebar-user-name { font-size: 0.85rem; font-weight: 500; color: var(--text-primary); }
        .sidebar-user-role { font-size: 0.75rem; color: var(--text-tertiary); }

        .logout-btn {
            background: none;
            border: none;
            color: var(--text-tertiary);
            cursor: none;
            padding: 0.3rem;
            transition: color 0.2s;
        }

        .logout-btn:hover { color: var(--red); }
        .logout-btn svg { width: 18px; height: 18px; }

        /* Main */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 3rem;
        }

        .topbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
        }

        .topbar-left h1 { font-size: 2rem; font-weight: 700; margin-bottom: 0.3rem; }
        .topbar-left p { color: var(--text-tertiary); font-size: 0.9rem; font-weight: 300; }
        .topbar-right { display: flex; align-items: center; gap: 0.8rem; }

        .build-mode {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.3rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            box-shadow: 0 2px 10px rgba(0,0,0,0.02);
        }

        .mode-btn {
            border: 1px solid transparent;
            background: transparent;
            color: var(--text-secondary);
            font-family: 'Oswald', sans-serif;
            font-size: 0.68rem;
            font-weight: 500;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            padding: 0.5rem 0.75rem;
            cursor: none;
            transition: all 0.2s var(--ease-out-expo);
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
        }

        .mode-btn:hover {
            color: var(--text-primary);
            border-color: var(--border);
        }

        .mode-btn.active {
            color: #fff;
            background: var(--accent-color);
            border-color: var(--accent-color);
            box-shadow: 0 0 20px var(--accent-color-glow);
        }

        .build-mode-hint {
            font-family: 'Oswald', sans-serif;
            font-size: 0.68rem;
            font-weight: 500;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: var(--text-tertiary);
        }

        /* Summary stats */
        .summary-bar {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .summary-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            padding: 1.5rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 10px rgba(0,0,0,0.02);
            opacity: 0;
            transform: translateY(15px);
            animation: fadeUp 0.5s var(--ease-out-expo) forwards;
        }

        .summary-card:nth-child(1) { animation-delay: 0.1s; }
        .summary-card:nth-child(2) { animation-delay: 0.15s; }
        .summary-card:nth-child(3) { animation-delay: 0.2s; }

        @keyframes fadeUp {
            to { opacity: 1; transform: translateY(0); }
        }

        .summary-label {
            font-family: 'Oswald', sans-serif;
            font-size: 0.7rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--text-tertiary);
            margin-bottom: 0.3rem;
        }

        .summary-value {
            font-family: 'Oswald', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            line-height: 1;
        }

        .summary-value.blue { color: var(--accent-color); }
        .summary-value.green { color: var(--green); }

        .summary-icon {
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(74,95,215,0.06);
            flex-shrink: 0;
        }

        .summary-icon svg {
            width: 22px;
            height: 22px;
            color: var(--accent-color);
        }

        .summary-icon.green-bg { background: var(--green-glow); }
        .summary-icon.green-bg svg { color: var(--green); }

        /* Order cards */
        .orders-grid {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .order-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            box-shadow: 0 2px 10px rgba(0,0,0,0.02);
            transition: all 0.3s var(--ease-out-expo);
            opacity: 0;
            transform: translateY(15px);
            animation: fadeUp 0.5s var(--ease-out-expo) forwards;
        }

        .order-card:nth-child(1) { animation-delay: 0.25s; }
        .order-card:nth-child(2) { animation-delay: 0.3s; }
        .order-card:nth-child(3) { animation-delay: 0.35s; }
        .order-card:nth-child(4) { animation-delay: 0.4s; }
        .order-card:nth-child(5) { animation-delay: 0.45s; }

        .order-card:hover {
            border-color: rgba(74,95,215,0.2);
            box-shadow: 0 8px 30px rgba(0,0,0,0.05), 0 0 40px var(--accent-color-glow);
        }

        .order-main {
            display: grid;
            grid-template-columns: 1fr auto auto auto;
            align-items: center;
            gap: 2rem;
            padding: 2rem 2.5rem;
        }

        .order-info { min-width: 0; }

        .order-client {
            font-family: 'Oswald', sans-serif;
            font-size: 0.7rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--accent-color);
            margin-bottom: 0.4rem;
        }

        .order-title {
            font-family: 'Oswald', sans-serif;
            font-size: 1.3rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.02em;
            margin-bottom: 0.5rem;
            line-height: 1.1;
        }

        .order-desc {
            font-size: 0.85rem;
            color: var(--text-secondary);
            font-weight: 300;
            line-height: 1.5;
        }

        .order-price {
            text-align: right;
            min-width: 120px;
        }

        .order-price-label {
            font-family: 'Oswald', sans-serif;
            font-size: 0.65rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--text-tertiary);
            margin-bottom: 0.3rem;
        }

        .order-price-value {
            font-family: 'Oswald', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-primary);
            line-height: 1;
        }

        .order-price-value .currency {
            font-size: 1rem;
            color: var(--accent-color);
            vertical-align: top;
        }

        .order-status {
            min-width: 110px;
            text-align: center;
        }

        .status-tag {
            font-family: 'Oswald', sans-serif;
            font-size: 0.7rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            padding: 0.4rem 1rem;
            display: inline-block;
        }

        .status-tag.wacht { color: var(--yellow); background: var(--yellow-glow); }
        .status-tag.actief { color: var(--accent-color); background: rgba(74,95,215,0.08); }
        .status-tag.bezig { color: var(--green); background: var(--green-glow); }
        .status-tag.klaar { color: var(--text-tertiary); background: rgba(0,0,0,0.03); }

        /* Execute button */
        .order-actions {
            min-width: 180px;
        }

        .execute-btn {
            width: 100%;
            padding: 0.8rem 1.5rem;
            background: var(--accent-color);
            color: white;
            font-family: 'Oswald', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            border: none;
            cursor: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: all 0.3s var(--ease-out-expo);
            position: relative;
            overflow: hidden;
        }

        .execute-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.12), transparent);
            transition: left 0.5s;
        }

        .execute-btn:hover {
            background: #3a4fc7;
            box-shadow: 0 0 30px var(--accent-color-glow);
            transform: translateY(-1px);
        }

        .execute-btn:hover::before { left: 100%; }

        .execute-btn svg { width: 16px; height: 16px; }

        .execute-btn.running {
            background: var(--green);
        }

        .execute-btn.running:hover {
            background: #219a52;
            box-shadow: 0 0 30px var(--green-glow);
        }

        .execute-btn.done {
            background: var(--bg-tertiary);
            color: var(--text-tertiary);
            pointer-events: none;
        }

        .view-btn {
            width: 100%;
            padding: 0.6rem 1.5rem;
            background: transparent;
            color: var(--accent-color);
            font-family: 'Oswald', sans-serif;
            font-size: 0.75rem;
            font-weight: 500;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            border: 1px solid rgba(74,95,215,0.2);
            cursor: none;
            margin-top: 0.5rem;
            transition: all 0.2s;
            display: none;
        }

        .view-btn:hover {
            background: rgba(74,95,215,0.05);
            border-color: var(--accent-color);
        }

        .view-btn.show { display: block; }

        /* Progress bar inside order */
        .order-progress {
            padding: 0 2.5rem 1.5rem;
            display: none;
        }

        .order-progress.show { display: block; }

        .progress-bar-bg {
            width: 100%;
            height: 4px;
            background: var(--border);
            position: relative;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-color), var(--accent-color-light));
            width: 0%;
            transition: width 0.5s var(--ease-out-expo);
        }

        .progress-bar-fill.green {
            background: linear-gradient(90deg, var(--green), #2ecc71);
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin-top: 0.8rem;
        }

        .progress-step {
            font-family: 'Oswald', sans-serif;
            font-size: 0.65rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-tertiary);
            transition: color 0.3s;
        }

        .progress-step.active { color: var(--accent-color); }
        .progress-step.done { color: var(--green); }

        /* Modal overlay */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.4);
            backdrop-filter: blur(8px);
            z-index: 5000;
            display: none;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .modal-overlay.show {
            display: flex;
            opacity: 1;
        }

        .modal {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            width: 90%;
            max-width: 600px;
            padding: 3rem;
            box-shadow: 0 30px 80px rgba(0,0,0,0.15);
            transform: translateY(20px);
            transition: transform 0.4s var(--ease-out-expo);
        }

        .modal-overlay.show .modal {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 2rem;
        }

        .modal-title {
            font-family: 'Oswald', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .modal-subtitle {
            font-size: 0.85rem;
            color: var(--text-secondary);
            font-weight: 300;
            margin-top: 0.3rem;
        }

        .modal-close {
            width: 36px;
            height: 36px;
            border: 1px solid var(--border);
            background: none;
            color: var(--text-tertiary);
            cursor: none;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            flex-shrink: 0;
        }

        .modal-close:hover {
            border-color: var(--red);
            color: var(--red);
        }

        .modal-close svg { width: 16px; height: 16px; }

        .modal-log {
            max-height: 250px;
            overflow-y: auto;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--bg-primary);
            border: 1px solid var(--border);
        }

        .modal-log::-webkit-scrollbar { width: 3px; }
        .modal-log::-webkit-scrollbar-thumb { background: var(--border); }

        .modal-log-entry {
            font-size: 0.8rem;
            color: var(--text-secondary);
            font-weight: 300;
            padding: 0.4rem 0;
            font-family: 'Inter', monospace;
            line-height: 1.6;
        }

        .modal-log-entry .time {
            color: var(--text-tertiary);
            font-size: 0.7rem;
            margin-right: 0.5rem;
        }

        .modal-log-entry .highlight {
            color: var(--accent-color);
            font-weight: 500;
        }

        .modal-log-entry .success {
            color: var(--green);
            font-weight: 500;
        }

        .modal-progress { margin-bottom: 2rem; }

        .modal-progress-text {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .modal-progress-label {
            font-family: 'Oswald', sans-serif;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-tertiary);
        }

        .modal-progress-pct {
            font-family: 'Oswald', sans-serif;
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--accent-color);
        }

        .modal-btn {
            width: 100%;
            padding: 1.2rem;
            font-family: 'Oswald', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border: none;
            cursor: none;
            transition: all 0.3s var(--ease-out-expo);
        }

        .modal-btn.primary {
            background: var(--green);
            color: white;
        }

        .modal-btn.primary:hover {
            background: #219a52;
            box-shadow: 0 0 30px var(--green-glow);
        }

        .modal-btn.secondary {
            background: var(--bg-primary);
            color: var(--text-secondary);
            border: 1px solid var(--border);
            margin-top: 0.5rem;
        }

        .modal-btn.secondary:hover {
            color: var(--text-primary);
            border-color: var(--text-tertiary);
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .order-main { grid-template-columns: 1fr auto auto; gap: 1.5rem; }
            .order-actions { min-width: 150px; }
            .summary-bar { grid-template-columns: 1fr; }
        }

        @media (max-width: 1024px) {
            body { cursor: auto; }
            .cursor, .cursor-dot { display: none; }
            .sidebar { display: none; }
            .main-content { margin-left: 0; }
            .order-main {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            .order-price { text-align: left; }
            .order-status { text-align: left; }
        }

        @media (max-width: 768px) {
            .main-content { padding: 1.5rem; }
            .topbar { flex-direction: column; align-items: flex-start; gap: 1rem; }
            .topbar-right { width: 100%; flex-direction: column; align-items: stretch; gap: 0.5rem; }
            .build-mode { width: 100%; }
            .mode-btn { flex: 1; justify-content: center; }
            .build-mode-hint { display: none; }
        }
    </style>
</head>
<body>

    <div class="noise-overlay"></div>
    <div class="cursor"></div>
    <div class="cursor-dot"></div>

    <div class="modal-overlay" id="modal" aria-hidden="true">
        <div class="modal" role="dialog" aria-modal="true" aria-label="Opdracht uitvoeren">
            <div class="modal-header">
                <div>
                    <div class="modal-title" id="modalTitle">Opdracht Uitvoeren</div>
                    <div class="modal-subtitle" id="modalSubtitle">AI bouwt de website...</div>
                </div>
                <button class="modal-close magnetic" type="button" id="modalCloseBtn">
                    <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
            </div>
            <div class="modal-progress">
                <div class="modal-progress-text">
                    <span class="modal-progress-label">Voortgang</span>
                    <span class="modal-progress-pct" id="modalPct">0%</span>
                </div>
                <div class="progress-bar-bg">
                    <div class="progress-bar-fill" id="modalBar" style="width: 0%;"></div>
                </div>
            </div>
            <div class="modal-log" id="modalLog"></div>
            <button class="modal-btn primary magnetic" id="modalBtn" type="button" style="display: none;">Oplevering Bekijken</button>
            <button class="modal-btn secondary magnetic" id="modalSecondaryBtn" type="button">Sluiten</button>
        </div>
    </div>

    <div class="dashboard-layout">

        <aside class="sidebar">
            <a href="maatwerk-platform.html" class="sidebar-logo magnetic">SOFTORA <span>SOFTWARE.</span></a>

            <nav class="sidebar-nav">
                <div class="sidebar-section">
                    <div class="sidebar-section-label">Overzicht</div>
                    <a href="personeel-dashboard.html" class="sidebar-link magnetic">
                        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
                        Dashboard
                    </a>
                    <a href="personeel-agenda.html" class="sidebar-link magnetic">
                        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M8 2v2m8-2v2M3 8h18M5 4h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V6a2 2 0 012-2z"/></svg>
                        Agenda
                    </a>
                    <a href="actieve-opdrachten.html" class="sidebar-link active magnetic">
                        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6M9 16h6M9 8h6"/><path stroke-linecap="round" stroke-linejoin="round" d="M7 20h10a2 2 0 002-2V6a2 2 0 00-2-2H7a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
                        Actieve Opdrachten
                        <span class="count-badge" id="sidebarCount">5</span>
                    </a>
                    <a href="ai-lead-generator.html" class="sidebar-link magnetic">
                        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-2.128a1.5 1.5 0 00-1.064-1.436l-3.084-.925a1.5 1.5 0 00-1.695.633l-.97 1.455a12.036 12.036 0 01-5.516-5.516l1.455-.97a1.5 1.5 0 00.633-1.695l-.925-3.084A1.5 1.5 0 008.878 2.25H6.75A2.25 2.25 0 004.5 4.5v2.25z"/></svg>
                        AI Coldcalling
                    </a>
                    <a href="ai-coldmailing.html" class="sidebar-link magnetic">
                        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15A2.25 2.25 0 012.25 17.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15A2.25 2.25 0 002.25 6.75m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.909a2.25 2.25 0 01-1.07-1.916V6.75"/></svg>
                        AI Coldmailing
                    </a>
                    <a href="seo-crm-system.html" class="sidebar-link magnetic">
                        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5V21h4.5L21 7.5l-4.5-4.5L3 16.5z"/><path stroke-linecap="round" stroke-linejoin="round" d="M12 20h9"/></svg>
                        SEO CRM SYSTEM
                    </a>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-label">Systeem</div>
                    <a href="#" class="sidebar-link magnetic">
                        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"/></svg>
                        Servers
                    </a>
                    <a href="#" class="sidebar-link magnetic">
                        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
                        Klanten
                    </a>
                    <a href="#" class="sidebar-link magnetic">
                        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.066 2.573c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.573 1.066c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.066-2.573c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><circle cx="12" cy="12" r="3"/></svg>
                        Instellingen
                    </a>
                </div>
            </nav>

            <div class="sidebar-footer">
                <div class="sidebar-user">
                    <div class="sidebar-avatar">SS</div>
                    <div class="sidebar-user-info">
                        <div class="sidebar-user-name">Softora Software</div>
                        <div class="sidebar-user-role">Administrator</div>
                    </div>
                    <a href="personeel-login.html" class="logout-btn magnetic" title="Uitloggen" aria-label="Uitloggen">
                        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/></svg>
                    </a>
                </div>
            </div>
        </aside>

        <main class="main-content">

            <div class="topbar">
                <div class="topbar-left">
                    <h1>Actieve Opdrachten</h1>
                    <p>Beheer en voer klantopdrachten uit met AI</p>
                </div>
                <div class="topbar-right">
                    <div class="build-mode" role="group" aria-label="Build modus">
                        <button class="mode-btn magnetic" type="button" data-build-mode="quick">Snelle Preview</button>
                        <button class="mode-btn magnetic" type="button" data-build-mode="premium">Premium AI Build</button>
                    </div>
                    <span class="build-mode-hint" id="buildModeHint">Snelle Preview</span>
                </div>
            </div>

            <div class="summary-bar">
                <div class="summary-card">
                    <div>
                        <div class="summary-label">Actieve Opdrachten</div>
                        <div class="summary-value blue" id="sumActive">5</div>
                    </div>
                    <div class="summary-icon">
                        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/></svg>
                    </div>
                </div>
                <div class="summary-card">
                    <div>
                        <div class="summary-label">Totale Waarde</div>
                        <div class="summary-value" id="sumTotal">€38.200</div>
                    </div>
                    <div class="summary-icon">
                        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                    </div>
                </div>
                <div class="summary-card">
                    <div>
                        <div class="summary-label">Opgeleverd Deze Maand</div>
                        <div class="summary-value green" id="sumDelivered">3</div>
                    </div>
                    <div class="summary-icon green-bg">
                        <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                    </div>
                </div>
            </div>

            <div class="orders-grid" id="ordersGrid">

                <div class="order-card" id="order-1" role="button" tabindex="0" aria-label="Opdracht 1">
                    <div class="order-main">
                        <div class="order-info">
                            <div class="order-client">Kapsalon Mooi — Breda</div>
                            <div class="order-title">Website Kapper met Online Booking</div>
                            <div class="order-desc">Moderne one-page website met diensten, prijslijst, team sectie en online afspraak-systeem.</div>
                        </div>
                        <div class="order-price">
                            <div class="order-price-label">Bedrag</div>
                            <div class="order-price-value"><span class="currency">€</span>2.800</div>
                        </div>
                        <div class="order-status">
                            <span class="status-tag wacht" id="status-1">Wachtend</span>
                        </div>
                        <div class="order-actions">
                            <button class="execute-btn magnetic" id="btn-1" type="button" data-order="1">
                                <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
                                Voer Opdracht Uit
                            </button>
                            <button class="view-btn magnetic" id="view-1" type="button" data-order="1">Bekijk Voortgang</button>
                        </div>
                    </div>
                    <div class="order-progress" id="progress-1">
                        <div class="progress-bar-bg"><div class="progress-bar-fill" id="bar-1"></div></div>
                        <div class="progress-steps">
                            <span class="progress-step" id="step-1-1">Analyse</span>
                            <span class="progress-step" id="step-1-2">Design</span>
                            <span class="progress-step" id="step-1-3">Development</span>
                            <span class="progress-step" id="step-1-4">Testing</span>
                            <span class="progress-step" id="step-1-5">Oplevering</span>
                        </div>
                    </div>
                </div>

                <div class="order-card" id="order-2" role="button" tabindex="0" aria-label="Opdracht 2">
                    <div class="order-main">
                        <div class="order-info">
                            <div class="order-client">Restaurant De Harmonie — Tilburg</div>
                            <div class="order-title">Restaurant Website met Menu & Reserveringen</div>
                            <div class="order-desc">Premium website met digitaal menu, fotogalerij, reserveringssysteem en Google Maps integratie.</div>
                        </div>
                        <div class="order-price">
                            <div class="order-price-label">Bedrag</div>
                            <div class="order-price-value"><span class="currency">€</span>3.500</div>
                        </div>
                        <div class="order-status">
                            <span class="status-tag wacht" id="status-2">Wachtend</span>
                        </div>
                        <div class="order-actions">
                            <button class="execute-btn magnetic" id="btn-2" type="button" data-order="2">
                                <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
                                Voer Opdracht Uit
                            </button>
                            <button class="view-btn magnetic" id="view-2" type="button" data-order="2">Bekijk Voortgang</button>
                        </div>
                    </div>
                    <div class="order-progress" id="progress-2">
                        <div class="progress-bar-bg"><div class="progress-bar-fill" id="bar-2"></div></div>
                        <div class="progress-steps">
                            <span class="progress-step" id="step-2-1">Analyse</span>
                            <span class="progress-step" id="step-2-2">Design</span>
                            <span class="progress-step" id="step-2-3">Development</span>
                            <span class="progress-step" id="step-2-4">Testing</span>
                            <span class="progress-step" id="step-2-5">Oplevering</span>
                        </div>
                    </div>
                </div>

                <div class="order-card" id="order-3" role="button" tabindex="0" aria-label="Opdracht 3">
                    <div class="order-main">
                        <div class="order-info">
                            <div class="order-client">FitLife Gym — Eindhoven</div>
                            <div class="order-title">Sportschool Website met Rooster</div>
                            <div class="order-desc">Energieke website met lesrooster, tarieven, trainer profielen en proefles aanvraag.</div>
                        </div>
                        <div class="order-price">
                            <div class="order-price-label">Bedrag</div>
                            <div class="order-price-value"><span class="currency">€</span>4.200</div>
                        </div>
                        <div class="order-status">
                            <span class="status-tag actief" id="status-3">Actief</span>
                        </div>
                        <div class="order-actions">
                            <button class="execute-btn magnetic" id="btn-3" type="button" data-order="3">
                                <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
                                Voer Opdracht Uit
                            </button>
                            <button class="view-btn magnetic" id="view-3" type="button" data-order="3">Bekijk Voortgang</button>
                        </div>
                    </div>
                    <div class="order-progress" id="progress-3">
                        <div class="progress-bar-bg"><div class="progress-bar-fill" id="bar-3"></div></div>
                        <div class="progress-steps">
                            <span class="progress-step" id="step-3-1">Analyse</span>
                            <span class="progress-step" id="step-3-2">Design</span>
                            <span class="progress-step" id="step-3-3">Development</span>
                            <span class="progress-step" id="step-3-4">Testing</span>
                            <span class="progress-step" id="step-3-5">Oplevering</span>
                        </div>
                    </div>
                </div>

                <div class="order-card" id="order-4" role="button" tabindex="0" aria-label="Opdracht 4">
                    <div class="order-main">
                        <div class="order-info">
                            <div class="order-client">Van der Berg Interiors — Den Bosch</div>
                            <div class="order-title">Interieurdesign Portfolio Website</div>
                            <div class="order-desc">Luxe portfolio met projectgalerij, before/after slider, klantreviews en contactformulier.</div>
                        </div>
                        <div class="order-price">
                            <div class="order-price-label">Bedrag</div>
                            <div class="order-price-value"><span class="currency">€</span>5.500</div>
                        </div>
                        <div class="order-status">
                            <span class="status-tag wacht" id="status-4">Wachtend</span>
                        </div>
                        <div class="order-actions">
                            <button class="execute-btn magnetic" id="btn-4" type="button" data-order="4">
                                <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
                                Voer Opdracht Uit
                            </button>
                            <button class="view-btn magnetic" id="view-4" type="button" data-order="4">Bekijk Voortgang</button>
                        </div>
                    </div>
                    <div class="order-progress" id="progress-4">
                        <div class="progress-bar-bg"><div class="progress-bar-fill" id="bar-4"></div></div>
                        <div class="progress-steps">
                            <span class="progress-step" id="step-4-1">Analyse</span>
                            <span class="progress-step" id="step-4-2">Design</span>
                            <span class="progress-step" id="step-4-3">Development</span>
                            <span class="progress-step" id="step-4-4">Testing</span>
                            <span class="progress-step" id="step-4-5">Oplevering</span>
                        </div>
                    </div>
                </div>

                <div class="order-card" id="order-5" role="button" tabindex="0" aria-label="Opdracht 5">
                    <div class="order-main">
                        <div class="order-info">
                            <div class="order-client">Bakkerij Jansen — Tilburg</div>
                            <div class="order-title">Bakkerij Website met Bestelmodule</div>
                            <div class="order-desc">Warme website met productoverzicht, online bestellen voor afhaal en bedrijfsverhaal.</div>
                        </div>
                        <div class="order-price">
                            <div class="order-price-label">Bedrag</div>
                            <div class="order-price-value"><span class="currency">€</span>22.200</div>
                        </div>
                        <div class="order-status">
                            <span class="status-tag wacht" id="status-5">Wachtend</span>
                        </div>
                        <div class="order-actions">
                            <button class="execute-btn magnetic" id="btn-5" type="button" data-order="5">
                                <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
                                Voer Opdracht Uit
                            </button>
                            <button class="view-btn magnetic" id="view-5" type="button" data-order="5">Bekijk Voortgang</button>
                        </div>
                    </div>
                    <div class="order-progress" id="progress-5">
                        <div class="progress-bar-bg"><div class="progress-bar-fill" id="bar-5"></div></div>
                        <div class="progress-steps">
                            <span class="progress-step" id="step-5-1">Analyse</span>
                            <span class="progress-step" id="step-5-2">Design</span>
                            <span class="progress-step" id="step-5-3">Development</span>
                            <span class="progress-step" id="step-5-4">Testing</span>
                            <span class="progress-step" id="step-5-5">Oplevering</span>
                        </div>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <script src="assets/premium-site-engine.js"></script>
    <script>
        const PREVIEW_HTML_PREFIX = 'softora_preview_html_software_v4_';
        const ARTIFACT_PREFIX = 'softora_site_artifact_software_v1_';
        const ORDER_STATE_KEY = 'softora_order_state_software_v1';
        const BUILD_MODE_KEY = 'softora_build_mode_software_v1';

        const orders = {
            1: { name: 'Kapsalon Mooi', type: 'Kapper Website', logs: [], progressPct: 0, previewHtml: null, artifact: null, updatedAt: null },
            2: { name: 'Restaurant De Harmonie', type: 'Restaurant Website', logs: [], progressPct: 0, previewHtml: null, artifact: null, updatedAt: null },
            3: { name: 'FitLife Gym', type: 'Sportschool Website', logs: [], progressPct: 0, previewHtml: null, artifact: null, updatedAt: null },
            4: { name: 'Van der Berg Interiors', type: 'Portfolio Website', logs: [], progressPct: 0, previewHtml: null, artifact: null, updatedAt: null },
            5: { name: 'Bakkerij Jansen', type: 'Bakkerij Website', logs: [], progressPct: 0, previewHtml: null, artifact: null, updatedAt: null }
        };

        const quickBuildSteps = [
            { pct: 5, step: 1, msg: 'Opdracht ontvangen, klantgegevens analyseren...' },
            { pct: 12, step: 1, msg: 'Branche-analyse en concurrentie-onderzoek gestart' },
            { pct: 20, step: 1, msg: 'Sitemap en content-structuur opgesteld' },
            { pct: 28, step: 2, msg: 'Kleurenpalet en typografie geselecteerd' },
            { pct: 38, step: 2, msg: 'Wireframes voor alle pagina\'s aangemaakt' },
            { pct: 45, step: 2, msg: 'Visueel design finalized — responsive mockups klaar' },
            { pct: 55, step: 3, msg: 'HTML/CSS structuur gegenereerd' },
            { pct: 62, step: 3, msg: 'Interactieve elementen en animaties ingebouwd' },
            { pct: 72, step: 3, msg: 'Formulieren en functionaliteit geïmplementeerd' },
            { pct: 80, step: 4, msg: 'Cross-browser testing gestart' },
            { pct: 85, step: 4, msg: 'Mobile responsiveness gevalideerd' },
            { pct: 90, step: 4, msg: 'Performance optimalisatie — Lighthouse score 95+' },
            { pct: 95, step: 5, msg: 'Finale check afgerond, bestanden klaargezet' },
            { pct: 100, step: 5, msg: 'Website succesvol opgeleverd!' }
        ];

        const premiumBuildSteps = [
            { pct: 4, step: 1, msg: 'Opdracht ontvangen, premium briefing analyseren...' },
            { pct: 10, step: 1, msg: 'Doelgroeppsychologie en positionering bepaald' },
            { pct: 18, step: 1, msg: 'Merktoon, hooks en storytelling-richting vastgesteld' },
            { pct: 26, step: 2, msg: '3 unieke creatieve concepten gegenereerd' },
            { pct: 34, step: 2, msg: 'Best presterende concept geselecteerd op conversie' },
            { pct: 42, step: 2, msg: 'High-end visuele richting en motion-stijl uitgewerkt' },
            { pct: 52, step: 3, msg: 'Volledige premium layout voor alle secties gebouwd' },
            { pct: 62, step: 3, msg: 'Copywriting en aanbodstructuur geoptimaliseerd' },
            { pct: 72, step: 3, msg: 'Interactie, formulieren en componenten afgerond' },
            { pct: 82, step: 4, msg: 'SEO-structuur, metadata en snelheid geoptimaliseerd' },
            { pct: 90, step: 4, msg: 'Cross-browser en mobile QA uitgevoerd' },
            { pct: 96, step: 5, msg: 'Final polish: hiërarchie, contrast en micro-copy' },
            { pct: 100, step: 5, msg: 'Premium website succesvol opgeleverd!' }
        ];

        let currentModalId = null;
        let buildMode = loadBuildMode();

        function getTime() {
            return new Date().toLocaleTimeString('nl-NL', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
        }

        function loadBuildMode() {
            try {
                const v = localStorage.getItem(BUILD_MODE_KEY);
                if (v === 'quick' || v === 'premium') return v;
                return 'premium';
            } catch (_) {
                return 'premium';
            }
        }

        function saveBuildMode(mode) {
            try {
                localStorage.setItem(BUILD_MODE_KEY, mode);
            } catch (_) {
                // ignore
            }
        }

        function getBuildSteps() {
            return buildMode === 'premium' ? premiumBuildSteps : quickBuildSteps;
        }

        function setBuildMode(mode) {
            buildMode = mode === 'premium' ? 'premium' : 'quick';
            saveBuildMode(buildMode);

            document.querySelectorAll('.mode-btn[data-build-mode]').forEach((btn) => {
                btn.classList.toggle('active', btn.getAttribute('data-build-mode') === buildMode);
            });

            const hint = document.getElementById('buildModeHint');
            if (hint) {
                hint.textContent = buildMode === 'premium'
                    ? 'Premium AI Build (best-of-4)'
                    : 'Snelle Preview';
            }
        }

        function moneyToNumber(text) {
            const raw = String(text || '').replace(/[^0-9]/g, '');
            const n = Number(raw);
            return Number.isFinite(n) ? n : null;
        }

        function escapeHtml(str) {
            return String(str || '')
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#039;');
        }

        function slugify(s) {
            return String(s || '')
                .toLowerCase()
                .replace(/[^a-z0-9\s-]/g, '')
                .trim()
                .replace(/\s+/g, '-')
                .replace(/-+/g, '-');
        }

        function deriveFeatures(desc) {
            const d = String(desc || '').trim();
            if (!d) return [];

            let source = d;
            const m = /\bmet\s+(.+?)(?:\.|$)/i.exec(d);
            if (m && m[1]) source = m[1];

            source = source.replace(/\s+en\s+/gi, ', ');
            return source
                .split(',')
                .map(s => s.trim())
                .filter(Boolean)
                .map(s => s.replace(/\.$/, ''))
                .slice(0, 8);
        }

        function getOrderMeta(id) {
            const card = document.getElementById('order-' + id);
            if (!card) return null;

            const clientLine = (card.querySelector('.order-client')?.textContent || '').trim();
            const title = (card.querySelector('.order-title')?.textContent || '').trim();
            const description = (card.querySelector('.order-desc')?.textContent || '').trim();
            const priceText = (card.querySelector('.order-price-value')?.textContent || '').trim();
            const budget = moneyToNumber(priceText);

            const parts = clientLine.split('—').map(s => s.trim()).filter(Boolean);
            const clientName = parts[0] || orders[id]?.name || 'Bedrijf';
            const location = parts[1] || '';

            const features = deriveFeatures(description);

            return {
                id: String(id),
                clientName,
                location,
                title: title || (orders[id]?.type || 'Project'),
                description,
                budget,
                features
            };
        }

        function formatBudget(n) {
            if (typeof n !== 'number' || !isFinite(n) || n <= 0) return '—';
            return '€' + n.toLocaleString('nl-NL');
        }

        function buildOutput(meta) {
            const slug = slugify(meta.clientName || meta.title || 'project');
            const repo = 'softora-' + slug + '-' + String(Date.now()).slice(-6);
            const previewUrl = 'opdracht-preview.html?id=' + encodeURIComponent(meta.id) + '&v=' + Date.now();
            return {
                repoName: repo,
                deployTarget: 'HTML',
                previewUrl,
                previewKey: PREVIEW_HTML_PREFIX + meta.id,
                createdAt: new Date().toISOString()
            };
        }

        function savePreviewHtml(orderId, html) {
            try {
                localStorage.setItem(PREVIEW_HTML_PREFIX + String(orderId), html);
            } catch (_) {
                // ignore
            }
        }

        function loadPreviewHtml(orderId) {
            try {
                return localStorage.getItem(PREVIEW_HTML_PREFIX + String(orderId));
            } catch (_) {
                return null;
            }
        }

        function saveArtifact(orderId, artifact) {
            try {
                localStorage.setItem(ARTIFACT_PREFIX + String(orderId), JSON.stringify(artifact));
            } catch (_) {
                // ignore
            }
        }

        function loadArtifact(orderId) {
            try {
                const raw = localStorage.getItem(ARTIFACT_PREFIX + String(orderId));
                return raw ? JSON.parse(raw) : null;
            } catch (_) {
                return null;
            }
        }

        function setLastActiveOrder(orderId) {
            try {
                localStorage.setItem(ORDER_STATE_KEY, JSON.stringify({
                    lastOrderId: String(orderId),
                    updatedAt: new Date().toISOString()
                }));
            } catch (_) {
                // ignore
            }
        }

        function selectActiveOrderId(explicitId) {
            if (explicitId && orders[explicitId]) return Number(explicitId);

            try {
                const raw = localStorage.getItem(ORDER_STATE_KEY);
                if (raw) {
                    const parsed = JSON.parse(raw);
                    const lastId = Number(parsed?.lastOrderId);
                    if (lastId && orders[lastId]) return lastId;
                }
            } catch (_) {
                // ignore
            }

            const byUpdated = Object.entries(orders)
                .map(([id, o]) => ({ id: Number(id), ts: Number(o.updatedAt || 0) }))
                .filter(x => Number.isFinite(x.ts) && x.ts > 0)
                .sort((a, b) => b.ts - a.ts);
            if (byUpdated.length) return byUpdated[0].id;

            const first = Object.keys(orders).map(Number).sort((a, b) => a - b)[0];
            return first || 1;
        }

        function materializeArtifactPage(artifact, fileName) {
            if (!artifact || !artifact.files) return null;
            const file = artifact.files[fileName] || artifact.files['index.html'];
            if (!file) return null;

            const css = String(artifact.files['assets/styles.css'] || '');
            const js = String(artifact.files['assets/app.js'] || '');

            return String(file)
                .replace(/<link[^>]*href="assets\/styles\.css"[^>]*>/i, `<style>\n${css}\n</style>`)
                .replace(/<script[^>]*src="assets\/app\.js"[^>]*><\/script>/i, `<script>\n${js}\n<\/script>`);
        }

        function buildArtifactForOrder(orderId) {
            const activeId = selectActiveOrderId(orderId);
            const meta = getOrderMeta(activeId);
            if (!meta) return null;

            if (!(window.PremiumSiteEngine && typeof window.PremiumSiteEngine.buildSiteBundle === 'function')) {
                const fallbackOutput = buildOutput(meta);
                const fallbackHtml = buildMode === 'premium'
                    ? generatePremiumPreviewHtml(meta, fallbackOutput)
                    : generatePreviewHtml(meta, fallbackOutput);
                orders[activeId].previewHtml = fallbackHtml;
                savePreviewHtml(activeId, fallbackHtml);
                return null;
            }

            const bundle = window.PremiumSiteEngine.buildSiteBundle({
                orderId: String(activeId),
                mode: buildMode,
                theme: 'light',
                source: 'ui-click',
                meta
            });

            orders[activeId].artifact = bundle;
            orders[activeId].previewHtml = bundle?.files?.['index.html'] || null;
            orders[activeId].updatedAt = Date.now();
            setLastActiveOrder(activeId);

            if (orders[activeId].previewHtml) {
                savePreviewHtml(activeId, orders[activeId].previewHtml);
            }
            saveArtifact(activeId, bundle);
            return bundle;
        }

        function generatePreviewHtml(meta, output) {
            const h = escapeHtml;

            const rawClient = String(meta.clientName || 'Bedrijf').trim();
            const rawLocation = String(meta.location || '').trim();
            const rawTitle = String(meta.title || '').trim();
            const rawDesc = String(meta.description || '').trim();
            const rawFeatures = Array.isArray(meta.features) ? meta.features.filter(Boolean).slice(0, 10) : [];

            function fnv1a(str) {
                let hash = 2166136261;
                for (let i = 0; i < str.length; i++) {
                    hash ^= str.charCodeAt(i);
                    hash = Math.imul(hash, 16777619);
                }
                return hash >>> 0;
            }

            function mulberry32(a) {
                return function () {
                    let t = a += 0x6D2B79F5;
                    t = Math.imul(t ^ (t >>> 15), t | 1);
                    t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
                    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
                };
            }

            const variantSalt = String(output?.variantSalt || '');
            const seedBase = [rawClient, rawTitle, rawLocation, rawDesc, String(meta.budget || ''), variantSalt, String(output?.createdAt || '')].join('|');
            const rand = mulberry32(fnv1a(seedBase));

            function pick(arr) {
                if (!Array.isArray(arr) || !arr.length) return null;
                return arr[Math.floor(rand() * arr.length)] || arr[0];
            }

            function shuffle(arr) {
                const a = (arr || []).slice();
                for (let i = a.length - 1; i > 0; i--) {
                    const j = Math.floor(rand() * (i + 1));
                    const tmp = a[i];
                    a[i] = a[j];
                    a[j] = tmp;
                }
                return a;
            }

            function hexToRgb(hex) {
                const v = String(hex || '').replace('#', '').trim();
                if (v.length !== 6) return { r: 74, g: 95, b: 215 };
                const n = parseInt(v, 16);
                return { r: (n >> 16) & 255, g: (n >> 8) & 255, b: n & 255 };
            }

            function rgba(hex, a) {
                const c = hexToRgb(hex);
                return `rgba(${c.r}, ${c.g}, ${c.b}, ${a})`;
            }

            function img(raw, w, h) {
                const base = String(raw || '').split('?')[0];
                const sep = base.includes('?') ? '&' : '?';
                const size = `&fit=crop&w=${w || 1200}&q=80&auto=format`;
                const height = h ? `&h=${h}` : '';
                return base + sep + size.slice(1) + height;
            }

            function classifyIndustry() {
                const t = `${rawClient} ${rawTitle} ${rawDesc}`.toLowerCase();
                if (/(kapsalon|kapper|barber|haar|hair|beauty)/.test(t)) return 'salon';
                if (/(restaurant|menu|reserver|diner|lunch|cafe|bistro)/.test(t)) return 'restaurant';
                if (/(sportschool|gym|fitness|rooster|proefles|trainer|pt)/.test(t)) return 'gym';
                if (/(interieur|portfolio|studio|architect|design)/.test(t)) return 'interior';
                if (/(bakkerij|brood|patisserie|bestel|gebak)/.test(t)) return 'bakery';
                return 'business';
            }

	            const industry = classifyIndustry();

	            function paletteFor(ind) {
	                const palettes = {
	                    salon: [
	                        { accent: '#8B2252', accent2: '#C43A78' },
	                        { accent: '#6B1A3F', accent2: '#FF4AA0' },
	                        { accent: '#7A1D46', accent2: '#D84B8A' },
	                        { accent: '#99214D', accent2: '#A62D65' }
	                    ],
	                    restaurant: [
	                        { accent: '#C45A12', accent2: '#F39C12' },
	                        { accent: '#8A3F1F', accent2: '#F97316' },
	                        { accent: '#A63B14', accent2: '#FB923C' },
	                        { accent: '#7C2D12', accent2: '#FDBA74' }
	                    ],
	                    gym: [
	                        { accent: '#1F9D67', accent2: '#2ECC71' },
	                        { accent: '#047857', accent2: '#10B981' },
	                        { accent: '#0E9F6E', accent2: '#34D399' },
	                        { accent: '#065F46', accent2: '#22C55E' }
	                    ],
	                    interior: [
	                        { accent: '#1A1A2E', accent2: '#4A5FD7' },
	                        { accent: '#0F172A', accent2: '#7B8EF8' },
	                        { accent: '#111827', accent2: '#60A5FA' },
	                        { accent: '#1E293B', accent2: '#38BDF8' }
	                    ],
	                    bakery: [
	                        { accent: '#B45309', accent2: '#F59E0B' },
	                        { accent: '#92400E', accent2: '#F97316' },
	                        { accent: '#7C2D12', accent2: '#FB923C' },
	                        { accent: '#9A3412', accent2: '#FDBA74' }
	                    ],
	                    business: [
	                        { accent: '#4A5FD7', accent2: '#7B8EF8' },
	                        { accent: '#0F172A', accent2: '#38BDF8' },
	                        { accent: '#111827', accent2: '#A78BFA' },
	                        { accent: '#1A1A2E', accent2: '#4A5FD7' }
	                    ]
	                };
	                const list = palettes[ind] || palettes.business;
	                const p = pick(list) || list[0];
	                return { accent: p.accent, accent2: p.accent2 };
	            }

	            const voice = pick(['direct', 'studio', 'poetic', 'bold']) || 'direct';

		            const archetypes = [
		                { id: 'cinema', order: ['menu','projects','process','beforeAfter','services','story','gallery','reviews','pricing','team','assortment','schedule','booking','faq','contact'] },
		                { id: 'editorial', order: ['story','services','process','projects','menu','pricing','team','gallery','reviews','assortment','schedule','booking','faq','contact'] },
		                { id: 'nebula', order: ['gallery','story','services','menu','projects','process','beforeAfter','pricing','team','reviews','assortment','schedule','booking','faq','contact'] },
		                { id: 'grid', order: ['menu','services','pricing','projects','process','beforeAfter','team','assortment','gallery','story','reviews','schedule','booking','faq','contact'] },
		                { id: 'poster', order: ['gallery','services','pricing','team','reviews','story','menu','projects','process','beforeAfter','assortment','schedule','booking','faq','contact'] },
		                { id: 'brutal', order: ['services','menu','gallery','pricing','story','team','reviews','projects','process','beforeAfter','assortment','schedule','booking','faq','contact'] }
		            ];
	            const arch = pick(archetypes) || archetypes[0];
	            const archId = arch?.id || 'cinema';
	            const palette = paletteFor(industry);

	            const icons = {
	                spark: '<svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 2l1.6 6.2L20 10l-6.4 1.8L12 18l-1.6-6.2L4 10l6.4-1.8L12 2z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/></svg>',
	                cal: '<svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M7 3v3M17 3v3M4 9h16M6 6h12a2 2 0 012 2v13a2 2 0 01-2 2H6a2 2 0 01-2-2V8a2 2 0 012-2z" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/></svg>',
	                bolt: '<svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M13 2L3 14h8l-1 8 10-12h-8l1-8z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/></svg>',
	                chat: '<svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 12a8 8 0 01-8 8H6l-3 3V12a8 8 0 018-8h2a8 8 0 018 8z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/></svg>',
                pin: '<svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 22s7-4.5 7-12a7 7 0 10-14 0c0 7.5 7 12 7 12z" stroke="currentColor" stroke-width="1.6"/><path d="M12 10.5a2.2 2.2 0 110-4.4 2.2 2.2 0 010 4.4z" stroke="currentColor" stroke-width="1.6"/></svg>',
                check: '<svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>'
            };

            function buildSpec() {
                const location = rawLocation || 'Nederland';
                const slug = slugify(rawClient || 'bedrijf');
                const email = `info@${slug}.nl`;
                const phone = '06 12 34 56 78';
                const address = rawLocation ? `Centrum, ${rawLocation}` : 'Centrum, Nederland';

                const base = {
                    brand: rawClient,
                    location,
                    email,
                    phone,
                    address,
                    socials: [
                        { label: 'Instagram', href: '#' },
                        { label: 'Facebook', href: '#' },
                        { label: 'Google', href: '#' }
                    ]
                };

                if (industry === 'salon') {
                    const images = [
                        'https://images.unsplash.com/photo-1595475884562-073c30d45670',
                        'https://images.unsplash.com/photo-1562322140-8baeececf3df',
                        'https://images.unsplash.com/photo-1580618672591-eb180b1a973f',
                        'https://images.unsplash.com/photo-1560869713-7d0a29430803',
                        'https://images.unsplash.com/photo-1600948836101-f9ffda59d250',
                        'https://images.unsplash.com/photo-1634449571010-02389ed0f9b0',
                        'https://images.unsplash.com/photo-1637777269327-c4d5c7944d7b'
                    ];

                    const portraits = [
                        'https://images.unsplash.com/photo-1573496359142-b8d87734a5a2',
                        'https://images.unsplash.com/photo-1560250097-0b93528c311a',
                        'https://images.unsplash.com/photo-1519085360753-af0119f7cbe7'
                    ];

                    return {
                        ...base,
                        bizType: 'Kapsalon',
                        accent: '#8B2252',
                        accent2: '#c43a78',
                        hero: {
                            kicker: `Kapsalon in ${location}`,
                            title: `Stijl die <span class="accent">blijft</span>.`,
                            subtitle: 'Knippen, kleuren en styling met aandacht. Boek eenvoudig online, wanneer het jou uitkomt.',
                            primary: { label: 'Boek afspraak', href: '#boeken' },
                            secondary: { label: 'Bekijk behandelingen', href: '#diensten' },
                            image: pick(images),
                            stats: [
                                { label: 'Google rating', value: '4.9' },
                                { label: 'Behandelingen', value: '20+' },
                                { label: 'Nieuwe klanten', value: 'Welkom' }
                            ]
                        },
                        nav: [
                            { href: '#diensten', label: 'Diensten' },
                            { href: '#prijzen', label: 'Prijzen' },
                            { href: '#team', label: 'Team' },
                            { href: '#galerie', label: 'Galerie' },
                            { href: '#contact', label: 'Contact' }
                        ],
                        services: [
                            { icon: icons.spark, title: 'Dames Knippen', desc: 'Van subtiel bijpunten tot complete make-over. Altijd met advies.' },
                            { icon: icons.spark, title: 'Heren & Barber', desc: 'Strakke fades, classic cuts en baard verzorging in stijl.' },
                            { icon: icons.spark, title: 'Kleur & Highlights', desc: 'Balayage, toner en highlights met een natuurlijke finish.' },
                            { icon: icons.spark, title: 'Styling & Verzorging', desc: 'Föhnen, bruidstyling en treatments voor gezond haar.' }
                        ],
                        pricing: [
                            { name: 'Essential', price: '€35', note: 'Knippen + styling', items: ['Consult & advies', 'Wassen + knippen', 'Föhnen & finish'] },
                            { name: 'Signature', price: '€75', note: 'Kleur + knippen', featured: true, items: ['Kleuranalyse', 'Kleur + toner', 'Knippen + styling'] },
                            { name: 'Premium', price: '€120', note: 'Balayage', items: ['Balayage techniek', 'Toner + care', 'Knippen + styling'] }
                        ],
                        team: [
                            { name: 'Noa', role: 'Top Stylist', img: portraits[0] },
                            { name: 'Milan', role: 'Color Specialist', img: portraits[1] },
                            { name: 'Sophie', role: 'Barber & Styling', img: portraits[2] }
                        ],
                        gallery: shuffle(images).slice(0, 6),
                        faq: [
                            { q: 'Hoe werkt online boeken?', a: 'Kies je behandeling, datum en tijd. Je ontvangt direct een bevestiging.' },
                            { q: 'Kan ik kosteloos annuleren?', a: 'Ja, tot 24 uur vooraf. Daarna brengen we mogelijk kosten in rekening.' },
                            { q: 'Doen jullie ook advies voor haarverzorging?', a: 'Zeker. We geven persoonlijk product- en routine-advies op basis van jouw haar.' }
                        ],
                        booking: { title: 'Online afspraak maken', subtitle: 'Kies een behandeling en plan je moment.' }
                    };
                }

                if (industry === 'restaurant') {
                    const images = [
                        'https://images.unsplash.com/photo-1600891964599-f61ba0e24092',
                        'https://images.unsplash.com/photo-1414235077428-338989a2e8c0',
                        'https://images.unsplash.com/photo-1550367363-ea12860cc124',
                        'https://images.unsplash.com/photo-1544025162-d76694265947',
                        'https://images.unsplash.com/photo-1502998070258-dc1338445ac2',
                        'https://images.unsplash.com/photo-1467003909585-2f8a72700288',
                        'https://images.unsplash.com/photo-1651440204227-a9a5b9d19712'
                    ];
                    const chef = 'https://images.unsplash.com/photo-1512485800893-b08ec1ea59b1';

                    return {
                        ...base,
                        bizType: 'Restaurant',
                        accent: '#c45a12',
                        accent2: '#f39c12',
                        hero: {
                            kicker: `Restaurant in ${location}`,
                            title: `Seizoensmenu met <span class="accent">karakter</span>.`,
                            subtitle: 'Een warme plek voor lunch, diner en een goed glas wijn. Reserveer in 30 seconden.',
                            primary: { label: 'Reserveer tafel', href: '#reserveren' },
                            secondary: { label: 'Bekijk menu', href: '#menu' },
                            image: pick(images),
                            stats: [
                                { label: 'Keuken', value: 'Seizoen' },
                                { label: 'Wijnkaart', value: '30+' },
                                { label: 'Reserveren', value: 'Online' }
                            ]
                        },
                        nav: [
                            { href: '#menu', label: 'Menu' },
                            { href: '#galerie', label: 'Galerie' },
                            { href: '#reserveren', label: 'Reserveren' },
                            { href: '#contact', label: 'Contact' }
                        ],
                        story: {
                            title: 'Over ons',
                            subtitle: 'Smaak, service en sfeer. Elke dag opnieuw.',
                            text: 'Wij koken met seizoensproducten en houden het simpel: goede ingrediënten, perfect uitgevoerd. Van intieme tafels tot grotere groepen.',
                            img: chef
                        },
                        menu: [
                            { cat: 'Voorgerechten', items: [
                                { name: 'Burrata', desc: 'Tomaat, basilicum, olijfolie', price: '€12' },
                                { name: 'Carpaccio', desc: 'Parmezaan, rucola, truffelmayo', price: '€13' },
                                { name: 'Soep van de dag', desc: 'Met brood & boter', price: '€8' }
                            ]},
                            { cat: 'Hoofdgerechten', items: [
                                { name: 'Steak frites', desc: 'Bearnaise, salade', price: '€24' },
                                { name: 'Zalm', desc: 'Citroen, kruiden, groenten', price: '€22' },
                                { name: 'Risotto', desc: 'Paddenstoelen, oude kaas', price: '€19' }
                            ]},
                            { cat: 'Desserts', items: [
                                { name: 'Tiramisu', desc: 'Klassiek huisgemaakt', price: '€9' },
                                { name: 'Cheesecake', desc: 'Seizoensfruit', price: '€9' },
                                { name: 'Affogato', desc: 'Espresso + vanille ijs', price: '€7' }
                            ]}
                        ],
                        gallery: shuffle(images).slice(0, 6),
                        testimonials: [
                            { name: 'Laura', text: 'Sfeervol, top service en echt een fantastisch menu. Aanrader.' },
                            { name: 'Daan', text: 'Heerlijke gerechten en je merkt dat alles vers is. Wij komen terug.' },
                            { name: 'Sofia', text: 'Perfect voor een avondje uit. Reserveren is super makkelijk.' }
                        ],
                        faq: [
                            { q: 'Zijn er vegetarische opties?', a: 'Ja, we hebben meerdere vegetarische gerechten en passen graag aan.' },
                            { q: 'Kunnen we met een groep reserveren?', a: 'Zeker. Voor grotere groepen adviseren we even te bellen.' },
                            { q: 'Is er een wisselend menu?', a: 'Ja. We werken seizoensgebonden en wisselen regelmatig.' }
                        ],
                        booking: { title: 'Reserveren', subtitle: 'Kies datum en tijd, wij regelen de rest.' },
                        images
                    };
                }

                if (industry === 'gym') {
                    const images = [
                        'https://images.unsplash.com/photo-1534438327276-14e5300c3a48',
                        'https://images.unsplash.com/photo-1571902943202-507ec2618e8f',
                        'https://images.unsplash.com/photo-1540497077202-7c8a3999166f',
                        'https://images.unsplash.com/photo-1581009146145-b5ef050c2e1e',
                        'https://images.unsplash.com/photo-1574680096145-d05b474e2155',
                        'https://images.unsplash.com/photo-1689877020200-403d8542d95d',
                        'https://images.unsplash.com/photo-1716367840407-f9414a84b325'
                    ];
                    const trainerPortraits = [
                        'https://images.unsplash.com/photo-1619361814016-4acc36025fa9',
                        'https://images.unsplash.com/photo-1619361728853-2542f3864532',
                        'https://images.unsplash.com/photo-1544972917-3529b113a469'
                    ];

                    return {
                        ...base,
                        bizType: 'Sportschool',
                        accent: '#1f9d67',
                        accent2: '#2ecc71',
                        hero: {
                            kicker: `Sportschool in ${location}`,
                            title: `Train slim. <span class="accent">Word sterk</span>.`,
                            subtitle: 'Moderne gym met duidelijke schema’s, coaches en een rooster dat werkt. Plan je proefles direct online.',
                            primary: { label: 'Plan proefles', href: '#proefles' },
                            secondary: { label: 'Bekijk rooster', href: '#rooster' },
                            image: pick(images),
                            stats: [
                                { label: 'Rooster', value: '7 dagen' },
                                { label: 'Trainers', value: '8+' },
                                { label: 'Proefles', value: 'Gratis' }
                            ]
                        },
                        nav: [
                            { href: '#rooster', label: 'Rooster' },
                            { href: '#prijzen', label: 'Tarieven' },
                            { href: '#trainers', label: 'Trainers' },
                            { href: '#contact', label: 'Contact' }
                        ],
                        schedule: [
                            { day: 'Ma', items: ['06:30 HIIT', '12:00 Strength', '18:30 Boxing'] },
                            { day: 'Di', items: ['07:00 Mobility', '12:15 Core', '19:00 Cross'] },
                            { day: 'Wo', items: ['06:30 Strength', '12:00 HIIT', '18:30 Yoga'] },
                            { day: 'Do', items: ['07:00 Cross', '12:15 Mobility', '19:00 Strength'] },
                            { day: 'Vr', items: ['06:30 HIIT', '12:00 Core', '18:00 Boxing'] },
                            { day: 'Za', items: ['09:00 Bootcamp', '11:00 Strength'] },
                            { day: 'Zo', items: ['10:00 Yoga', '11:30 Mobility'] }
                        ],
                        pricing: [
                            { name: 'Basic', price: '€29', note: 'Per maand', items: ['Open gym', '1 groepsles p/w', 'App toegang'] },
                            { name: 'Unlimited', price: '€49', note: 'Per maand', featured: true, items: ['Onbeperkt lessen', 'Open gym', 'Persoonlijk schema'] },
                            { name: 'Pro', price: '€89', note: 'Per maand', items: ['Unlimited', '2x PT per maand', 'Metingen & coaching'] }
                        ],
                        team: [
                            { name: 'Jay', role: 'Strength Coach', img: trainerPortraits[0] },
                            { name: 'Nina', role: 'Mobility & Yoga', img: trainerPortraits[1] },
                            { name: 'Ravi', role: 'HIIT & Boxing', img: trainerPortraits[2] }
                        ],
                        gallery: shuffle(images).slice(0, 6),
                        faq: [
                            { q: 'Is de proefles echt gratis?', a: 'Ja. We plannen 1 proefles zodat je sfeer en coaching kunt ervaren.' },
                            { q: 'Kan ik mijn abonnement pauzeren?', a: 'Dat kan in overleg, bijvoorbeeld bij blessure of vakantie.' },
                            { q: 'Is er begeleiding voor beginners?', a: 'Zeker. We bouwen rustig op met techniek en een passend schema.' }
                        ],
                        booking: { title: 'Proefles aanvragen', subtitle: 'Laat je gegevens achter, dan plannen we een moment.' }
                    };
                }

                if (industry === 'interior') {
                    const images = [
                        'https://images.unsplash.com/photo-1618221195710-dd6b41faaea6',
                        'https://images.unsplash.com/photo-1586023492125-27b2c045efd7',
                        'https://images.unsplash.com/photo-1618220179428-22790b461013',
                        'https://images.unsplash.com/photo-1606744837616-56c9a5c6a6eb',
                        'https://images.unsplash.com/photo-1616046229478-9901c5536a45',
                        'https://images.unsplash.com/photo-1564078516393-cf04bd966897',
                        'https://images.unsplash.com/photo-1583847268964-b28dc8f51f92'
                    ];
                    const portrait = 'https://images.unsplash.com/photo-1558222218-b7b54eede3f3';

                    return {
                        ...base,
                        bizType: 'Interieurdesign',
                        accent: '#1a1a2e',
                        accent2: '#4a5fd7',
                        hero: {
                            kicker: `Interieurdesign • ${location}`,
                            title: `Ruimtes die <span class="accent">rust</span> geven.`,
                            subtitle: 'Van concept tot oplevering: een interieur dat klopt in licht, indeling en detail. Bekijk projecten en plan een kennismaking.',
                            primary: { label: 'Plan kennismaking', href: '#contact' },
                            secondary: { label: 'Bekijk projecten', href: '#projecten' },
                            image: pick(images),
                            stats: [
                                { label: 'Projecten', value: '50+' },
                                { label: 'Stijl', value: 'Tijdloos' },
                                { label: 'Doorlooptijd', value: '2-6 wk' }
                            ]
                        },
                        nav: [
                            { href: '#projecten', label: 'Projecten' },
                            { href: '#proces', label: 'Proces' },
                            { href: '#reviews', label: 'Reviews' },
                            { href: '#contact', label: 'Contact' }
                        ],
	                        story: {
	                            title: 'Werken met aandacht',
	                            subtitle: 'Geen ruis, wel resultaat.',
	                            text: 'We vertalen jouw wensen naar een interieur dat klopt. Met duidelijke stappen, visuals en keuzes die passen bij jouw ruimte en budget.',
	                            img: portrait
	                        },
	                        process: [
	                            { title: 'Intake & Doelen', desc: 'We bepalen stijlrichting, budget, planning en de echte wensen achter het project.' },
	                            { title: 'Concept & Moodboard', desc: 'We werken 2-3 richtingen uit met materialen, kleuren, indeling en licht.' },
	                            { title: 'Visuals & Keuzes', desc: 'Heldere visuals en keuzes per ruimte, zodat je precies weet wat je krijgt.' },
	                            { title: 'Inkoop & Planning', desc: 'Shoppinglist, leveranciers, timing en budgetbewaking. Alles strak geregeld.' },
	                            { title: 'Styling & Oplevering', desc: 'Finishing touches, styling en oplevering. Een ruimte die echt klopt.' }
	                        ],
	                        projects: [
	                            { title: 'Woonkamer Make-over', tag: 'Wonen', desc: 'Rust, warmte en een slimme indeling met op maat details.', img: images[0] },
	                            { title: 'Keuken & Eetkamer', tag: 'Renovatie', desc: 'Lichtplan, materiaalkeuze en een praktische flow voor dagelijks gebruik.', img: images[1] },
	                            { title: 'Slaapkamer Suite', tag: 'Styling', desc: 'Hotelgevoel met zachte materialen en balans in contrast.', img: images[2] }
	                        ],
                        beforeAfter: { before: images[3], after: images[4] },
                        testimonials: [
                            { name: 'Eva', text: 'Het plan was super duidelijk en het resultaat voelt echt als “ons huis”.' },
                            { name: 'Tom', text: 'Fijn proces, snel schakelen en prachtige details. Aanrader.' },
                            { name: 'Nora', text: 'Van inspiratie naar uitvoering: strak geregeld en heel smaakvol.' }
                        ],
                        faq: [
                            { q: 'Werken jullie met vaste pakketten?', a: 'We kunnen pakketprijzen aanbieden, maar starten altijd met een korte intake.' },
                            { q: 'Kunnen jullie ook alleen een lichtplan maken?', a: 'Ja. We leveren ook losse onderdelen zoals lichtplan of moodboard.' },
                            { q: 'Doen jullie ook uitvoering/begeleiding?', a: 'Ja. Van inkoop tot planning kunnen we begeleiden.' }
                        ]
                    };
                }

                if (industry === 'bakery') {
                    const images = [
                        'https://images.unsplash.com/photo-1674770067314-296af21ad811',
                        'https://images.unsplash.com/photo-1702742794767-f65248632da1',
                        'https://images.unsplash.com/photo-1702742803242-2ffd88953909',
                        'https://images.unsplash.com/photo-1702742794772-e6bf74d11754',
                        'https://images.unsplash.com/photo-1631131799562-5acc477d8252',
                        'https://images.unsplash.com/photo-1677825948767-5d379d012bda',
                        'https://images.unsplash.com/photo-1702742800078-06d9e9af4fd8'
                    ];

                    return {
                        ...base,
                        bizType: 'Bakkerij',
                        accent: '#b45309',
                        accent2: '#f59e0b',
                        hero: {
                            kicker: `Bakkerij in ${location}`,
                            title: `Elke ochtend <span class="accent">vers</span> uit de oven.`,
                            subtitle: 'Brood, patisserie en specials. Bestel online voor afhaal en ontdek het verhaal achter onze recepten.',
                            primary: { label: 'Bestel voor afhaal', href: '#bestellen' },
                            secondary: { label: 'Bekijk assortiment', href: '#assortiment' },
                            image: pick(images),
                            stats: [
                                { label: 'Vers', value: 'Dagelijks' },
                                { label: 'Assortiment', value: '40+' },
                                { label: 'Afhaal', value: 'Online' }
                            ]
                        },
                        nav: [
                            { href: '#assortiment', label: 'Assortiment' },
                            { href: '#bestellen', label: 'Bestellen' },
                            { href: '#verhaal', label: 'Verhaal' },
                            { href: '#contact', label: 'Contact' }
                        ],
                        products: [
                            { name: 'Desem Brood', price: '€5,50', tag: 'Signature', img: images[0] },
                            { name: 'Croissant', price: '€2,25', tag: 'Boter', img: images[1] },
                            { name: 'Kaneelbroodje', price: '€3,25', tag: 'Sweet', img: images[2] },
                            { name: 'Taartpunt', price: '€4,50', tag: 'Patisserie', img: images[3] },
                            { name: 'Meergranen', price: '€4,75', tag: 'Dagelijks', img: images[4] },
                            { name: 'Baguette', price: '€2,80', tag: 'Lunch', img: images[5] }
                        ],
                        story: {
                            title: 'Ons verhaal',
                            subtitle: 'Ambacht, tijd en goede ingrediënten.',
                            text: 'We werken met lange fermentatie, echte boter en lokale leveranciers waar het kan. Zo proef je het verschil in elke hap.',
                            img: images[6]
                        },
                        faq: [
                            { q: 'Hoe werkt online bestellen?', a: 'Kies product, datum en tijd. We zetten je bestelling klaar voor afhaal.' },
                            { q: 'Kunnen jullie ook catering doen?', a: 'Ja. Voor bedrijven en events kunnen we pakketten samenstellen.' },
                            { q: 'Zijn er allergenen-vrije opties?', a: 'We hebben opties zonder noten en bieden info per product.' }
                        ],
                        gallery: shuffle(images).slice(0, 6),
                        booking: { title: 'Bestellen voor afhaal', subtitle: 'Snel geregeld, vers voor je klaar.' }
                    };
                }

                // Default business
                const images = [
                    'https://images.unsplash.com/photo-1460925895917-afdab827c52f',
                    'https://images.unsplash.com/photo-1498050108023-c5249f4df085',
                    'https://images.unsplash.com/photo-1519389950473-47ba0277781c',
                    'https://images.unsplash.com/photo-1558494949-ef010cbdcc31'
                ];

                return {
                    ...base,
                    bizType: 'Bedrijf',
                    accent: '#4a5fd7',
                    accent2: '#7b8ef8',
                    hero: {
                        kicker: rawLocation ? rawLocation : 'Nederland',
                        title: `Professioneel. <span class="accent">Snel</span>. Duidelijk.`,
                        subtitle: rawDesc || 'Een moderne website met heldere structuur, sterke visuals en focus op conversie.',
                        primary: { label: 'Neem contact op', href: '#contact' },
                        secondary: { label: 'Bekijk diensten', href: '#diensten' },
                        image: pick(images),
                        stats: [
                            { label: 'SEO', value: 'Basis+' },
                            { label: 'Design', value: 'Custom' },
                            { label: 'Snelheid', value: '95+' }
                        ]
                    },
                    nav: [
                        { href: '#diensten', label: 'Diensten' },
                        { href: '#galerie', label: 'Galerie' },
                        { href: '#contact', label: 'Contact' }
                    ],
                    services: [
                        { icon: icons.bolt, title: 'Webdesign', desc: 'Heldere hiërarchie, moderne uitstraling en consistente CTA’s.' },
                        { icon: icons.bolt, title: 'Development', desc: 'Schone code, snel laden en klaar voor groei.' },
                        { icon: icons.bolt, title: 'SEO Basis', desc: 'Structuur, meta’s en performance als fundament.' }
                    ],
                    gallery: shuffle(images).slice(0, 3),
                    faq: [
                        { q: 'Hoe snel kan het live?', a: 'Dat hangt af van content en scope. Meestal binnen enkele weken.' },
                        { q: 'Kan ik later uitbreiden?', a: 'Ja. De opzet is modulair zodat we eenvoudig kunnen opschalen.' },
                        { q: 'Doen jullie ook onderhoud?', a: 'Ja. We kunnen updates en doorontwikkeling verzorgen.' }
                    ]
                };
            }

	            const spec = buildSpec();

	            // Apply a premium palette and elevate copy so every preview feels unique.
	            spec.accent = palette.accent;
	            spec.accent2 = palette.accent2;

	            function accentSpan(text) {
	                return `<span class="accent">${h(text)}</span>`;
	            }

	            function normalizePillLabel(s) {
	                const t = String(s || '').trim().toLowerCase();
	                if (!t) return '';
	                if (/(online|afspraak|booking|reserver)/.test(t)) return 'Online planning';
	                if (/(bestel|afhaal|order)/.test(t)) return 'Online bestellen';
	                if (/(prijslijst|prijzen|tarief)/.test(t)) return 'Prijzen & pakketten';
	                if (/(team|trainers|coach)/.test(t)) return 'Team & rollen';
	                if (/(rooster|agenda|planning)/.test(t)) return 'Rooster / planning';
	                if (/(galerie|foto|fotogalerij)/.test(t)) return 'Galerie';
	                if (/(seo|performance|lighthouse|snel)/.test(t)) return 'Snel & SEO-ready';
	                return t.replace(/\bsectie\b/g, '').replace(/\s+/g, ' ').trim().replace(/^./, c => c.toUpperCase());
	            }

	            function pillIcon(label) {
	                const t = String(label || '').toLowerCase();
	                if (/(planning|agenda|book|reserve|proef)/.test(t)) return icons.cal;
	                if (/(seo|snel|performance|score)/.test(t)) return icons.bolt;
	                if (/(design|stijl|branding|galerie|look)/.test(t)) return icons.spark;
	                return icons.check;
	            }

	            function uniqueSignature(ind) {
	                const fromFeatures = (rawFeatures || []).map(normalizePillLabel).filter(Boolean);
	                const add = {
	                    salon: ['Signature cut', 'Color lab', 'Aftercare plan', 'Balayage', 'Barber corner', 'No‑rush experience'],
	                    restaurant: ['Seizoensmenu', 'Wijn pairing', 'Chef’s table', 'Online reserveren', 'Private dining', 'Sfeerfotografie'],
	                    gym: ['Progressieplan', 'Proefles online', 'Metingen & coaching', 'Groepslessen', '7 dagen rooster', 'Community'],
	                    interior: ['Moodboard', 'Lichtplan', 'Materialenbibliotheek', 'Inkooplijst', 'Projectbegeleiding', 'Budget helder'],
	                    bakery: ['Dagelijks vers', 'Desem', 'Online afhaal', 'Custom taarten', 'Catering', 'Assortiment 40+'],
	                    business: ['SEO fundament', 'Performance', 'Conversie', 'Analytics', 'Support & groei']
	                };
	                const base = (add[ind] || add.business).concat(fromFeatures);
	                const labels = shuffle(Array.from(new Set(base))).slice(0, 4);
	                return labels.map(l => ({ label: l, icon: pillIcon(l) }));
	            }

	            function heroCopy(ind, location) {
	                const loc = location || 'Nederland';
	                const packs = {
	                    salon: {
	                        direct: {
	                            kicker: [`Kapsalon in ${loc}`, `Hair studio • ${loc}`, `Kapsalon • ${loc}`],
	                            title: [`Stijl die ${accentSpan('blijft')}.`, `Knip. Kleur. ${accentSpan('Karakter')}.`, `Je haar, maar ${accentSpan('beter')}.`],
	                            subtitle: [
	                                'Knippen, kleuren en styling met aandacht. Online boeken, heldere prijzen, strak resultaat.',
	                                'Precision cuts en kleur met diepte. Plan je stoel in 30 seconden.',
	                                'Van touch‑up tot make‑over. Rustig luxe, technisch sterk.'
	                            ]
	                        },
	                        poetic: {
	                            kicker: [`Rustige luxe • ${loc}`, `Studio • ${loc}`],
	                            title: [`Lijn. Licht. ${accentSpan('Look')}.`, `Zacht, maar ${accentSpan('scherp')}.`],
	                            subtitle: [
	                                'Een salonervaring zonder haast. Jij binnen, wij precies.',
	                                'Kleur met nuance, knipwerk met ritme. Online plannen, klaar.'
	                            ]
	                        },
	                        studio: {
	                            kicker: [`Hair design • ${loc}`, `Studio appointments • ${loc}`],
	                            title: [`Design‑first ${accentSpan('hair')}.`, `${accentSpan('Signature')} styling.`],
	                            subtitle: [
	                                'We ontwerpen een look die past bij jouw gezicht, routine en stijl. Online boeken inbegrepen.',
	                                'Kleuradvies, techniek en aftercare. Alles strak geregeld.'
	                            ]
	                        },
	                        bold: {
	                            kicker: [`Kapsalon • ${loc}`],
	                            title: [`Maak ${accentSpan('impact')}.`, `Kleur die ${accentSpan('praat')}.`],
	                            subtitle: [
	                                'Geen grijs gebied: duidelijke keuzes, strak resultaat. Boek online.',
	                                'Van roots tot balayage: wij bouwen kleur in lagen.'
	                            ]
	                        }
	                    },
	                    restaurant: {
	                        direct: {
	                            kicker: [`Restaurant in ${loc}`, `Keuken • ${loc}`],
	                            title: [`Seizoen op je ${accentSpan('bord')}.`, `Smaak in ${accentSpan('lagen')}.`],
	                            subtitle: [
	                                'Warm, precies en zonder gedoe. Online reserveren in 30 seconden.',
	                                'Van eerste slok tot laatste hap: ritme, service en een menu dat klopt.'
	                            ]
	                        },
	                        poetic: {
	                            kicker: [`Avond • ${loc}`],
	                            title: [`Tafel voor ${accentSpan('twee')}.`, `Smaak die ${accentSpan('blijft')}.`],
	                            subtitle: [
	                                'Sfeer die je voelt, gerechten die je onthoudt. Reserveer online.',
	                                'Seizoensproducten, rustige luxe, perfect uitgevoerd.'
	                            ]
	                        },
	                        studio: {
	                            kicker: [`Chef’s kitchen • ${loc}`],
	                            title: [`Menu met ${accentSpan('karakter')}.`],
	                            subtitle: [
	                                'Chef’s selectie, wijn pairing en een strak reserveringsflow. Premium uitstraling, snel laden.'
	                            ]
	                        },
	                        bold: {
	                            kicker: [`Restaurant • ${loc}`],
	                            title: [`Eet. Vier. ${accentSpan('Herhaal')}.`],
	                            subtitle: [
	                                'Geen poespas. Wel smaak. Reserveren? Online, klaar.'
	                            ]
	                        }
	                    },
	                    gym: {
	                        direct: {
	                            kicker: [`Sportschool in ${loc}`, `Training • ${loc}`],
	                            title: [`Sterk is een ${accentSpan('systeem')}.`, `Train met ${accentSpan('richting')}.`],
	                            subtitle: [
	                                'Coaches, schema’s en een rooster dat werkt. Plan je proefles direct online.',
	                                'Progressie zonder ruis: duidelijke blocks, techniek eerst.'
	                            ]
	                        },
	                        poetic: {
	                            kicker: [`Progressie • ${loc}`],
	                            title: [`Rust. Ritme. ${accentSpan('Resultaat')}.`],
	                            subtitle: [
	                                'Je lichaam leert wat je herhaalt. Wij maken herhaling slim.',
	                                'Sterker worden, zonder chaos. Proefles online.'
	                            ]
	                        },
	                        studio: {
	                            kicker: [`Performance gym • ${loc}`],
	                            title: [`Build your ${accentSpan('baseline')}.`],
	                            subtitle: [
	                                'Metingen, coaching en blokken. Een systeem dat schaalt met jou.'
	                            ]
	                        },
	                        bold: {
	                            kicker: [`Gym • ${loc}`],
	                            title: [`Geen excuses. ${accentSpan('Plan')}.`],
	                            subtitle: [
	                                'Rooster. Coach. Progressie. Alles strak ingericht.'
	                            ]
	                        }
	                    },
	                    interior: {
	                        direct: {
	                            kicker: [`Interieurdesign • ${loc}`, `Studio • ${loc}`],
	                            title: [`Ruimte als ${accentSpan('rust')}.`, `Interieur met ${accentSpan('logica')}.`],
	                            subtitle: [
	                                'Van concept tot oplevering: licht, indeling en detail in balans.',
	                                'Heldere stappen, sterke visuals, keuzes die kloppen.'
	                            ]
	                        },
	                        poetic: {
	                            kicker: [`Ruimte • ${loc}`],
	                            title: [`Stilte in ${accentSpan('vorm')}.`],
	                            subtitle: [
	                                'Een interieur dat ademt. Zacht in materiaal, scherp in lijn.',
	                                'We bouwen rust met ritme en detail.'
	                            ]
	                        },
	                        studio: {
	                            kicker: [`Interior studio • ${loc}`],
	                            title: [`Tijdloos. ${accentSpan('Precisie')}.`],
	                            subtitle: [
	                                'Moodboard, lichtplan en inkooplijst. Strak proces, premium output.'
	                            ]
	                        },
	                        bold: {
	                            kicker: [`Interieur • ${loc}`],
	                            title: [`Maak ruimte voor ${accentSpan('impact')}.`],
	                            subtitle: [
	                                'Duidelijke keuzes. Sterke materialen. Klaar.'
	                            ]
	                        }
	                    },
	                    bakery: {
	                        direct: {
	                            kicker: [`Bakkerij in ${loc}`, `Bakkerij • ${loc}`],
	                            title: [`Elke ochtend ${accentSpan('vers')}.`, `Tijd smaakt ${accentSpan('beter')}.`],
	                            subtitle: [
	                                'Brood, patisserie en specials. Bestel online voor afhaal.',
	                                'Lange fermentatie, echte boter, klaar voor je tas.'
	                            ]
	                        },
	                        poetic: {
	                            kicker: [`Ovenwarm • ${loc}`],
	                            title: [`Fermentatie. Vuur. ${accentSpan('Geduld')}.`],
	                            subtitle: [
	                                'Ambacht is tijd. En tijd proef je.',
	                                'Bestellen voor afhaal: snel, vers, precies.'
	                            ]
	                        },
	                        studio: {
	                            kicker: [`Bakery studio • ${loc}`],
	                            title: [`Ambacht als ${accentSpan('systeem')}.`],
	                            subtitle: [
	                                'Assortiment, pre‑order en sterke productfotografie in een snelle webshop‑flow.'
	                            ]
	                        },
	                        bold: {
	                            kicker: [`Bakkerij • ${loc}`],
	                            title: [`Vers is ${accentSpan('verslavend')}.`],
	                            subtitle: [
	                                'Bestel. Haal op. Klaar. Elke ochtend opnieuw.'
	                            ]
	                        }
	                    },
	                    business: {
	                        direct: {
	                            kicker: [loc, 'Nederland'],
	                            title: [`Professioneel. ${accentSpan('Snel')}. Duidelijk.`, `Websites die ${accentSpan('verkopen')}.`],
	                            subtitle: [
	                                rawDesc || 'Een moderne website met heldere structuur, sterke visuals en focus op conversie.',
	                                'Design met hiërarchie. Copy met intentie. Performance als standaard.'
	                            ]
	                        },
	                        poetic: {
	                            kicker: [loc],
	                            title: [`Rustig. ${accentSpan('Scherp')}.`],
	                            subtitle: [
	                                'Een site die aanvoelt als een goed gesprek: kort, helder, overtuigend.'
	                            ]
	                        },
	                        studio: {
	                            kicker: [loc],
	                            title: [`Design. Code. ${accentSpan('Resultaat')}.`],
	                            subtitle: [
	                                'Custom build, schaalbaar en snel. Klaar voor groei en SEO.'
	                            ]
	                        },
	                        bold: {
	                            kicker: [loc],
	                            title: [`Maak ${accentSpan('ruimte')}. Voor groei.`],
	                            subtitle: [
	                                'Geen rommel. Alleen een site die werkt.'
	                            ]
	                        }
	                    }
	                };

	                const pack = (packs[ind] || packs.business);
	                const v = (pack[voice] || pack.direct);
	                return {
	                    kicker: pick(v.kicker) || (pack.direct.kicker ? pick(pack.direct.kicker) : loc),
	                    title: pick(v.title) || pick(pack.direct.title) || '',
	                    subtitle: pick(v.subtitle) || pick(pack.direct.subtitle) || ''
	                };
	            }

	            const hc = heroCopy(industry, spec.location);
		            if (spec.hero) {
		                spec.hero.kicker = hc.kicker;
		                spec.hero.title = hc.title;
		                spec.hero.subtitle = hc.subtitle;
		            }

		            spec.signature = uniqueSignature(industry);

		            function buildCampaign(ind) {
		                const req = `${rawTitle} ${rawDesc} ${(rawFeatures || []).join(' ')}`.toLowerCase();
		                const wantsBooking = /(booking|afspraak|reserver|reserve|reservering|rooster|proefles|agenda)/.test(req);
		                const wantsOrdering = /(bestel|afhaal|order|bestelmodule|webshop)/.test(req);
		                const wantsPortfolio = /(portfolio|project|galerij|gallery|cases?)/.test(req);

		                const micro = {
		                    salon: wantsBooking ? ['Online boeken', 'Nieuwe klanten welkom', 'Aftercare plan'] : ['Signature cut', 'Color lab', 'No-rush ervaring'],
		                    restaurant: wantsBooking ? ['Online reserveren', 'Seizoensmenu', 'Sfeer & service'] : ['Seizoensmenu', 'Wijn pairing', 'Private dining'],
		                    gym: wantsBooking ? ['Proefles online', '7 dagen rooster', 'Coaching'] : ['Progressieplan', 'Metingen', 'Community'],
		                    interior: wantsPortfolio ? ['Projectgalerij', 'Moodboard', 'Transparant per fase'] : ['Moodboard', 'Lichtplan', 'Budget helder'],
		                    bakery: wantsOrdering ? ['Online afhaal', 'Dagelijks vers', 'Custom taarten'] : ['Dagelijks vers', 'Desem', 'Assortiment'],
		                    business: ['Conversie focus', 'Snel & SEO-ready', 'Heldere structuur']
		                };

		                const proof = {
		                    salon: [
		                        { value: '4.9', label: 'Rating' },
		                        { value: '30s', label: 'Boeken' },
		                        { value: '0', label: 'Gedoe' }
		                    ],
		                    restaurant: [
		                        { value: '4.8', label: 'Rating' },
		                        { value: '1x', label: 'Klik' },
		                        { value: 'Seizoen', label: 'Menu' }
		                    ],
		                    gym: [
		                        { value: '7', label: 'Dagen' },
		                        { value: '12w', label: 'Plan' },
		                        { value: '1x', label: 'Proefles' }
		                    ],
		                    interior: [
		                        { value: '24u', label: 'Reactie' },
		                        { value: '3', label: 'Fases' },
		                        { value: '100%', label: 'Maatwerk' }
		                    ],
		                    bakery: [
		                        { value: 'Elke dag', label: 'Vers' },
		                        { value: 'Online', label: 'Afhaal' },
		                        { value: '40+', label: 'Assort.' }
		                    ],
		                    business: [
		                        { value: '95+', label: 'Speed' },
		                        { value: 'SEO', label: 'Ready' },
		                        { value: '1', label: 'Flow' }
		                    ]
		                };

		                const bank = {
		                    salon: [
		                        () => ({
		                            kicker: 'Methode',
		                            navLabel: 'Methode',
		                            sectionId: 'belofte',
		                            headlineHtml: `Boek je stoel in ${accentSpan('30 seconden')}.`,
		                            subhead: 'Kies behandeling, selecteer tijd, klaar. Ontworpen om nieuwe klanten zonder drempel binnen te halen.',
		                            bullets: [
		                                'Online boeken met directe bevestiging',
		                                'Behandelingen en prijzen in 1 oogopslag',
		                                'Look die klopt in vorm, kleur en routine'
		                            ],
		                            mechanism: {
		                                tag: 'Het systeem',
		                                titleHtml: `${accentSpan('Shape-first')} knipwerk + kleur in lagen`,
		                                desc: 'We knippen op val en volume, bouwen kleur met nuance en geven aftercare die je thuis volhoudt.'
		                            },
		                            offer: {
		                                tag: 'Nieuwe klanten',
		                                titleHtml: `Korte ${accentSpan('style scan')} + advies`,
		                                desc: 'Niet zeker wat je wil? We bepalen samen de route. Kort, helder en zonder verkoopdruk.',
		                                items: ['Advies op gezicht & routine', 'Behandeling die past bij jouw doel', 'Aftercare tips voor thuis']
		                            }
		                        }),
		                        () => ({
		                            kicker: 'Belofte',
		                            navLabel: 'Belofte',
		                            sectionId: 'belofte',
		                            headlineHtml: `Kleur met ${accentSpan('diepte')}. Zonder hardheid.`,
		                            subhead: 'Van touch-up tot balayage: we bouwen kleur in lagen zodat het natuurlijk blijft, ook weken later.',
		                            bullets: [
		                                'Kleuradvies op ondertoon en lifestyle',
		                                'Rustige luxe: tijd en aandacht zonder haast',
		                                'Online boeken met duidelijke prijsindicatie'
		                            ],
		                            mechanism: {
		                                tag: 'Color lab',
		                                titleHtml: `${accentSpan('Tone map')} + gloss finish`,
		                                desc: 'We stemmen warmte/koelte af op je huid, bouwen dimensie, en sluiten af met een gloss voor glans.'
		                            },
		                            offer: {
		                                tag: 'Plan je stoel',
		                                titleHtml: `Boek online, ${accentSpan('wij regelen de rest')}.`,
		                                desc: 'Kies je behandeling. Wij zorgen voor timing, techniek en een resultaat dat blijft vallen.',
		                                items: ['Heldere behandelingen', 'Techniek met nuance', 'Aftercare plan']
		                            }
		                        })
		                    ],
		                    restaurant: [
		                        () => ({
		                            kicker: 'Ervaring',
		                            navLabel: 'Ervaring',
		                            sectionId: 'belofte',
		                            headlineHtml: `Reserveren zonder ${accentSpan('frictie')}.`,
		                            subhead: 'Van menu tot tafel: alles klopt. Snel reserveren, duidelijke informatie en sfeer die je voelt.',
		                            bullets: [
		                                'Online reserveren in seconden',
		                                'Seizoensmenu met heldere keuzes',
		                                'Perfect voor date night of groepen'
		                            ],
		                            mechanism: {
		                                tag: 'Menu-first',
		                                titleHtml: `Een menu dat ${accentSpan('trekt')}.`,
		                                desc: 'We tonen specials en favorieten met ritme en beeld, zodat je sneller kiest en vaker terugkomt.'
		                            },
		                            offer: {
		                                tag: 'Reserveer',
		                                titleHtml: `Tafel klaar. ${accentSpan('Jij hoeft alleen te komen')}.`,
		                                desc: 'Reserveer online en ontvang direct bevestiging. Liever bellen? Dat kan ook.',
		                                items: ['Directe bevestiging', 'Allergenen duidelijk', 'Google Maps + route']
		                            }
		                        }),
		                        () => ({
		                            kicker: 'Belofte',
		                            navLabel: 'Belofte',
		                            sectionId: 'belofte',
		                            headlineHtml: `Seizoen op je ${accentSpan('bord')}.`,
		                            subhead: 'Smaak in lagen, service zonder ruis. Een avond die je onthoudt en doorvertelt.',
		                            bullets: [
		                                'Seizoensproducten en specials',
		                                'Wijn pairing als optie',
		                                'Reserveren en menu altijd up-to-date'
		                            ],
		                            mechanism: {
		                                tag: 'Keuken',
		                                titleHtml: `${accentSpan('Smaak')} met ritme.`,
		                                desc: 'We koken strak: textuur, balans en timing. Van eerste slok tot laatste hap.'
		                            },
		                            offer: {
		                                tag: 'Aan tafel',
		                                titleHtml: `Reserveer. ${accentSpan('Geniet')}. Herhaal.`,
		                                desc: 'Korte route naar je tafel, lange herinnering in je hoofd.',
		                                items: ['Snel reserveren', 'Fotogalerij sfeer', 'Reviews zichtbaar']
		                            }
		                        })
		                    ],
		                    gym: [
		                        () => ({
		                            kicker: 'Protocol',
		                            navLabel: 'Protocol',
		                            sectionId: 'belofte',
		                            headlineHtml: `Progressie met een ${accentSpan('protocol')}.`,
		                            subhead: 'Geen chaos. Wel een plan dat je volhoudt. Met coaching, metingen en een rooster dat werkt.',
		                            bullets: [
		                                'Proefles online plannen',
		                                'Schema’s op doel en niveau',
		                                'Coaching die techniek bewaakt'
		                            ],
		                            mechanism: {
		                                tag: 'Het systeem',
		                                titleHtml: `${accentSpan('Baseline')} → blocks → resultaat`,
		                                desc: 'We bouwen je basis, werken in blokken en meten voortgang zodat motivatie niet leunt op gevoel.'
		                            },
		                            offer: {
		                                tag: 'Start',
		                                titleHtml: `Plan je ${accentSpan('proefles')} in 1 minuut.`,
		                                desc: 'Kies een moment. Wij zorgen voor een coach en een duidelijke eerste sessie.',
		                                items: ['7 dagen rooster', 'Intake + meting', 'Plan voor 4 weken']
		                            }
		                        })
		                    ],
		                    interior: [
		                        () => ({
		                            kicker: 'Werkwijze',
		                            navLabel: 'Werkwijze',
		                            sectionId: 'belofte',
		                            headlineHtml: `Rust in lijn. Helder ${accentSpan('plan')}.`,
		                            subhead: 'We vertalen wensen naar een interieur dat klopt in licht, indeling en detail. Zonder ruis.',
		                            bullets: [
		                                'Moodboard en richting in week 1',
		                                'Lichtplan, materialen en keuzes helder',
		                                'Projecten en details visueel sterk'
		                            ],
		                            mechanism: {
		                                tag: 'Methode',
		                                titleHtml: `${accentSpan('Logica')} + sfeer + detail`,
		                                desc: 'We beginnen bij functie, bouwen sfeer met materiaal, en sluiten af op detail zodat het echt af voelt.'
		                            },
		                            offer: {
		                                tag: 'Intake',
		                                titleHtml: `Korte intake. ${accentSpan('Duidelijk voorstel')}.`,
		                                desc: 'Je weet waar je aan toe bent: fases, budget en deliverables.',
		                                items: ['Transparant per fase', 'Inkooplijst als optie', 'Begeleiding tot oplevering']
		                            }
		                        })
		                    ],
		                    bakery: [
		                        () => ({
		                            kicker: 'Vers',
		                            navLabel: 'Vers',
		                            sectionId: 'belofte',
		                            headlineHtml: `Ovenwarm. Vooraf ${accentSpan('bestellen')}.`,
		                            subhead: 'Geen misgrijpen. Bestel online, haal af wanneer het jou uitkomt. Elke dag vers uit de oven.',
		                            bullets: [
		                                'Online bestellen voor afhaal',
		                                'Dagelijks vers brood en patisserie',
		                                'Custom taarten op aanvraag'
		                            ],
		                            mechanism: {
		                                tag: 'Ambacht',
		                                titleHtml: `${accentSpan('Tijd')} proef je.`,
		                                desc: 'Lange fermentatie, goede ingrediënten en een oven die elke ochtend opnieuw aan staat.'
		                            },
		                            offer: {
		                                tag: 'Afhalen',
		                                titleHtml: `Bestel. ${accentSpan('Haal op')}. Klaar.`,
		                                desc: 'Snel bestellen, duidelijke tijden en een assortiment dat je wil zien.',
		                                items: ['Assortiment overzicht', 'Specials in beeld', 'Catering optioneel']
		                            }
		                        })
		                    ],
		                    business: [
		                        () => ({
		                            kicker: 'Aanpak',
		                            navLabel: 'Aanpak',
		                            sectionId: 'belofte',
		                            headlineHtml: `Meer leads. Minder ${accentSpan('ruis')}.`,
		                            subhead: 'Een website met hiërarchie, intentie en performance. Zodat bezoekers snappen, voelen en klikken.',
		                            bullets: [
		                                'Positionering en copy die converteert',
		                                'Snelheid als standaard (Lighthouse 90+)',
		                                'SEO-structuur als fundament'
		                            ],
		                            mechanism: {
		                                tag: 'Blueprint',
		                                titleHtml: `${accentSpan('Clarity')} → trust → actie`,
		                                desc: 'We bouwen een flow met één doel: de juiste bezoeker naar de juiste CTA, zonder afleiding.'
		                            },
		                            offer: {
		                                tag: 'Start',
		                                titleHtml: `Korte call. ${accentSpan('Duidelijk plan')}.`,
		                                desc: 'We bepalen scope, structuur en prioriteiten. Daarna bouwen we strak door.',
		                                items: ['Sitemap + wireframe', 'Design + build', 'Launch + nazorg']
		                            }
		                        })
		                    ]
		                };

		                const variantFactory = pick(bank[ind] || bank.business) || (bank.business ? bank.business[0] : (() => ({})));
		                const v = variantFactory();
		                const heroMicro = v.heroMicro && v.heroMicro.length ? v.heroMicro : (micro[ind] || micro.business);
		                const note = v.note || heroMicro.join(' • ');
		                const proofItems = v.proof && v.proof.length ? v.proof : (proof[ind] || proof.business || []);

		                return {
		                    sectionId: v.sectionId || 'belofte',
		                    navLabel: v.navLabel || 'Belofte',
		                    kicker: v.kicker || 'Belofte',
		                    headlineHtml: v.headlineHtml || `Een ${accentSpan('heldere')} keuze.`,
		                    subhead: v.subhead || '',
		                    bullets: (v.bullets || []).slice(0, 4),
		                    mechanism: v.mechanism || {},
		                    offer: v.offer || {},
		                    heroMicro,
		                    note,
		                    proof: proofItems.slice(0, 3)
		                };
		            }

		            spec.campaign = buildCampaign(industry);
		            if (spec.campaign && Array.isArray(spec.nav)) {
		                const href = '#' + String(spec.campaign.sectionId || 'belofte');
		                if (!spec.nav.some(l => l && l.href === href)) {
		                    spec.nav = [{ href, label: String(spec.campaign.navLabel || 'Belofte') }].concat(spec.nav);
		                }
		            }

		            if (!spec.story) {
		                const storyText = {
		                    salon: 'We starten bij jouw gezichtsvorm, haarstructuur en routine. Daarna bouwen we een look die klopt: technisch, rustig en draagbaar.',
		                    restaurant: 'We koken met seizoensproducten en houden het strak: smaak, service en sfeer. Van intieme tafels tot grotere groepen.',
	                    gym: 'We trainen op techniek en progressie. Niet harder om het harder, maar slimmer om het beter. Met een plan dat je volhoudt.',
	                    interior: 'We vertalen wensen naar een interieur dat klopt in licht, indeling en detail. Heldere stappen, geen ruis.',
	                    bakery: 'We werken met tijd: lange fermentatie, goede ingrediënten en een oven die elke ochtend opnieuw aan staat. Bestel online, haal vers af.',
	                    business: 'We bouwen een merkwaardige, snelle en duidelijke website. Design met intentie, code met discipline en copy die converteert.'
	                };
	                const storyTitle = {
	                    salon: 'Onze aanpak',
	                    restaurant: 'Onze keuken',
	                    gym: 'Trainingsfilosofie',
	                    interior: 'Werkwijze',
	                    bakery: 'Ons ambacht',
	                    business: 'Zo werken we'
	                };
	                spec.story = {
	                    title: storyTitle[industry] || 'Over ons',
	                    subtitle: 'Waar we voor staan',
	                    text: storyText[industry] || storyText.business,
	                    img: spec.hero?.image
	                };
	            }

	            if (!spec.testimonials) {
	                const bank = {
	                    salon: [
	                        { name: 'Noor', text: 'Super relaxte sfeer en écht vakwerk. Mijn kleur is precies goed.' },
	                        { name: 'Sam', text: 'Online boeken is top. Snel geholpen en strak geknipt.' },
	                        { name: 'Lotte', text: 'Eindelijk een kapsel dat de weken erna nog steeds goed valt.' }
	                    ],
	                    restaurant: (spec.testimonials || []),
	                    gym: [
	                        { name: 'Daan', text: 'Duidelijke coaching en een rooster dat je volhoudt. Progressie voelt logisch.' },
	                        { name: 'Iris', text: 'Techniek eerst. Daardoor train ik eindelijk zonder pijntjes.' },
	                        { name: 'Ruben', text: 'Proefles aangevraagd, direct goed contact. Goede vibe.' }
	                    ],
	                    interior: (spec.testimonials || []),
	                    bakery: [
	                        { name: 'Eva', text: 'Alles smaakt vers en het online bestellen werkt perfect.' },
	                        { name: 'Milan', text: 'Die croissants zijn bizar goed. Echt boter, echt knapperig.' },
	                        { name: 'Sara', text: 'Taart op maat besteld: prachtig en heerlijk.' }
	                    ],
	                    business: [
	                        { name: 'Lina', text: 'Strak design, snelle site en vooral: duidelijke structuur. Top.' },
	                        { name: 'Koen', text: 'Goede communicatie en een website die echt professioneel voelt.' },
	                        { name: 'Mehdi', text: 'Performance is bizar goed. Alles laadt direct.' }
	                    ]
	                };
	                spec.testimonials = bank[industry] || bank.business;
	            }

	            const accentGlow = rgba(spec.accent, 0.20);
	            const accentGlow2 = rgba(spec.accent2, 0.16);

            const pageTitle = h(`${spec.brand} | ${spec.bizType}${rawLocation ? ' ' + rawLocation : ''}`);
            const metaDescription = h(rawDesc || `${spec.bizType} in ${spec.location}. Bekijk diensten, prijzen en neem contact op.`);

            const navLinks = (spec.nav || []).map(l => `<a href="${l.href}">${h(l.label)}</a>`).join('');
            const primaryCta = spec.hero?.primary ? `<a class="btn primary" href="${spec.hero.primary.href}">${h(spec.hero.primary.label)}</a>` : '';
            const secondaryCta = spec.hero?.secondary ? `<a class="btn ghost" href="${spec.hero.secondary.href}">${h(spec.hero.secondary.label)}</a>` : '';

	            const heroStats = (spec.hero?.stats || []).slice(0, 3).map(s => (
	                `<div class="mini"><div class="mini-v">${h(s.value)}</div><div class="mini-l">${h(s.label)}</div></div>`
	            )).join('');

	            const heroStatsMedia = heroStats ? `<div class="mini-grid on-media">${heroStats}</div>` : '';
	            const heroStatsCopy = heroStats ? `<div class="mini-grid on-copy">${heroStats}</div>` : '';

		            const heroPills = (spec.signature || []).slice(0, 4).map(p => (
		                `<span class="pill">${p.icon || icons.check}<span>${h(p.label)}</span></span>`
		            )).join('');
		            const heroPillsWrap = heroPills ? `<div class="pills">${heroPills}</div>` : '';
		            const heroNote = spec.campaign?.note ? `<div class="hero-note">${h(spec.campaign.note)}</div>` : '';

	            const services = (spec.services || []).map((s) => (
	                `<article class="card reveal">
	                  <div class="icon">${s.icon || icons.spark}</div>
	                  <h3>${h(s.title)}</h3>
                  <p>${h(s.desc)}</p>
                </article>`
            )).join('');

            const featureList = (rawFeatures.length ? rawFeatures : ['Modern design', 'Snelle laadtijd', 'Mobiel geoptimaliseerd', 'SEO basis', 'Duidelijke conversie']).slice(0, 8)
                .map(f => `<li><span class="li-ic">${icons.check}</span><span>${h(f)}</span></li>`).join('');

	            const gallery = (spec.gallery || []).map((u, i) => (
	                `<figure class="g-item reveal">
	                  <img src="${img(u, 1200, 900)}" alt="${h(spec.bizType)} foto ${i + 1}" loading="lazy" decoding="async" />
	                </figure>`
	            )).join('');

	            const pricingCtaHref = spec.hero?.primary?.href || '#contact';
	            const pricingCtaLabel = spec.hero?.primary?.label || 'Neem contact op';

	            const pricing = (spec.pricing || []).map((p) => {
	                const items = (p.items || []).map(it => `<li>${h(it)}</li>`).join('');
	                return `<article class="price-card reveal ${p.featured ? 'featured' : ''}">
	                  ${p.featured ? '<div class="badge">Populair</div>' : ''}
	                  <div class="p-name">${h(p.name)}</div>
	                  <div class="p-price">${h(p.price)}</div>
	                  <div class="p-note">${h(p.note || '')}</div>
	                  <ul class="p-list">${items}</ul>
	                  <a class="btn ${p.featured ? 'primary' : 'ghost'}" href="${pricingCtaHref}">${h(pricingCtaLabel)}</a>
	                </article>`;
	            }).join('');

            const testimonials = (spec.testimonials || []).map(t => (
                `<article class="quote reveal">
                  <p>“${h(t.text)}”</p>
                  <div class="who">${h(t.name)}</div>
                </article>`
            )).join('');

            const faq = (spec.faq || []).map(item => (
                `<details class="faq-item reveal">
                  <summary>${h(item.q)}</summary>
                  <div class="faq-a"><p>${h(item.a)}</p></div>
                </details>`
            )).join('');

	            const team = (spec.team || []).map(m => (
	                `<article class="person reveal">
	                  <div class="person-img">
	                    <img src="${img(m.img, 900, 1100)}" alt="Portret ${h(m.name)}" loading="lazy" decoding="async" />
	                  </div>
	                  <div class="person-body">
	                    <div class="person-name">${h(m.name)}</div>
	                    <div class="person-role">${h(m.role)}</div>
	                  </div>
	                </article>`
	            )).join('');

	            const storySectionId = (spec.nav || []).some(l => l && l.href === '#verhaal') ? 'verhaal' : 'over';
	            const storySecondaryHref = (spec.gallery && spec.gallery.length) ? '#galerie' : (Array.isArray(spec.projects) ? '#projecten' : '#contact');
	            const storySecondaryLabel = (spec.gallery && spec.gallery.length) ? 'Bekijk sfeer' : (Array.isArray(spec.projects) ? 'Bekijk projecten' : 'Bekijk contact');

	            const teamSectionId = (spec.nav || []).some(l => l && l.href === '#trainers') ? 'trainers' : 'team';
	            const teamKicker = teamSectionId === 'trainers' ? 'Trainers' : 'Team';
	            const teamTitle = teamSectionId === 'trainers' ? 'Coaches & Trainers' : 'Mensen achter het werk';
	            const teamText = teamSectionId === 'trainers'
	                ? 'Professionele coaches met focus op techniek, progressie en motivatie.'
	                : 'Een professionele teamsectie met sterke portretten en duidelijke rollen.';

	            const story = spec.story ? `
	                <section class="section alt" id="${storySectionId}">
	                  <div class="wrap grid2">
	                    <div class="reveal">
	                      <div class="k">${h(spec.story.subtitle || '')}</div>
	                      <h2>${h(spec.story.title || 'Over ons')}</h2>
	                      <p>${h(spec.story.text || '')}</p>
	                      <div class="row" style="margin-top: 1.2rem;">
	                        <a class="btn primary" href="#contact">Neem contact op</a>
	                        <a class="btn ghost" href="${storySecondaryHref}">${h(storySecondaryLabel)}</a>
	                      </div>
	                    </div>
	                    <div class="media reveal">
	                      <img src="${img(spec.story.img, 1400, 1100)}" alt="${h(spec.bizType)} sfeerbeeld" loading="lazy" decoding="async" />
	                    </div>
	                  </div>
	                </section>` : '';

            const menuSection = Array.isArray(spec.menu) ? `
                <section class="section" id="menu">
	                  <div class="wrap">
	                    <div class="head">
	                      <div class="k">Menu</div>
	                      <h2>Geselecteerde Gerechten</h2>
	                      <p>Een selectie van onze favorieten. Vraag naar wisselende specials of reserveer direct online.</p>
	                    </div>
	                    <div class="menu-grid">
	                      ${spec.menu.map(cat => `
	                        <div class="menu-cat reveal">
                          <div class="menu-title">${h(cat.cat)}</div>
                          <div class="menu-items">
                            ${(cat.items || []).map(it => `
                              <div class="menu-item">
                                <div class="menu-name">${h(it.name)}</div>
                                <div class="menu-price">${h(it.price)}</div>
                                <div class="menu-desc">${h(it.desc)}</div>
                              </div>`).join('')}
                          </div>
                        </div>`).join('')}
                    </div>
                  </div>
                </section>` : '';

            const scheduleSection = Array.isArray(spec.schedule) ? `
                <section class="section alt" id="rooster">
	                  <div class="wrap">
	                    <div class="head">
	                      <div class="k">Rooster</div>
	                      <h2>Wekelijkse Lessen</h2>
	                      <p>Dit is ons weekrooster. Reserveer je plek en kom trainen op jouw moment.</p>
	                    </div>
	                    <div class="schedule reveal">
	                      ${spec.schedule.map(d => `
	                        <div class="day">
                          <div class="day-h">${h(d.day)}</div>
                          <div class="day-b">${(d.items || []).map(x => `<span>${h(x)}</span>`).join('')}</div>
                        </div>`).join('')}
                    </div>
                  </div>
                </section>` : '';

	            const projectsSection = Array.isArray(spec.projects) ? `
	                <section class="section" id="projecten">
		                  <div class="wrap">
		                    <div class="head">
		                      <div class="k">Projecten</div>
		                      <h2>Geselecteerde Cases</h2>
		                      <p>Een selectie van recente projecten. Licht, materiaal en indeling in balans, tot in de details.</p>
		                    </div>
		                    <div class="proj-grid">
		                      ${spec.projects.map(p => `
		                        <article class="proj reveal">
	                          <div class="proj-img"><img src="${img(p.img, 1400, 1100)}" alt="${h(p.title)}" loading="lazy" decoding="async" /></div>
	                          <div class="proj-body">
	                            <div class="tag">${h(p.tag)}</div>
	                            <h3>${h(p.title)}</h3>
	                            <p>${h(p.desc)}</p>
	                          </div>
	                        </article>`).join('')}
	                    </div>
	                  </div>
	                </section>` : '';

	            const processSection = Array.isArray(spec.process) ? `
	                <section class="section alt" id="proces">
	                  <div class="wrap">
	                    <div class="head">
	                      <div class="k">Proces</div>
	                      <h2>Van Intake tot Oplevering</h2>
	                      <p>Compact, voorspelbaar en premium. Duidelijke stappen, zonder ruis.</p>
	                    </div>
	                    <div class="grid3">
	                      ${(spec.process || []).map((st, idx) => `
	                        <article class="card reveal">
	                          <div class="tag">Stap ${String(idx + 1).padStart(2,'0')}</div>
	                          <h3>${h(st.title)}</h3>
	                          <p>${h(st.desc)}</p>
	                        </article>`).join('')}
	                    </div>
	                  </div>
	                </section>` : '';

	            const beforeAfterSection = spec.beforeAfter ? `
	                <section class="section alt" id="voor-na">
		                  <div class="wrap">
		                    <div class="head">
		                      <div class="k">Voor / Na</div>
		                      <h2>Impact in 1 Slider</h2>
		                      <p>Sleep de slider en zie het verschil: van uitgangspunt naar eindresultaat.</p>
		                    </div>
		                    <div class="ba reveal" id="ba">
		                      <img class="ba-img" src="${img(spec.beforeAfter.before, 1600, 1000)}" alt="Voor" loading="lazy" decoding="async" />
                      <div class="ba-top" id="baTop">
                        <img class="ba-img" src="${img(spec.beforeAfter.after, 1600, 1000)}" alt="Na" loading="lazy" decoding="async" />
                      </div>
                      <div class="ba-handle" id="baHandle"></div>
                      <input class="ba-range" id="baRange" type="range" min="15" max="85" value="50" />
                    </div>
                  </div>
                </section>` : '';

            const assortmentSection = Array.isArray(spec.products) ? `
                <section class="section" id="assortiment">
                  <div class="wrap">
                    <div class="head">
                      <div class="k">Assortiment</div>
                      <h2>Populaire Producten</h2>
                      <p>Snelle overzichtspagina met filters, categorieën en sterke productfoto’s.</p>
                    </div>
                    <div class="prod-grid">
                      ${spec.products.map(p => `
                        <article class="prod reveal">
                          <div class="prod-img"><img src="${img(p.img, 1200, 900)}" alt="${h(p.name)}" loading="lazy" decoding="async" /></div>
                          <div class="prod-body">
                            <div class="tag">${h(p.tag)}</div>
                            <div class="prod-row">
                              <h3>${h(p.name)}</h3>
                              <div class="prod-price">${h(p.price)}</div>
                            </div>
                          </div>
                        </article>`).join('')}
                    </div>
                  </div>
                </section>` : '';

            const bookingId = industry === 'restaurant' ? 'reserveren' : (industry === 'bakery' ? 'bestellen' : (industry === 'gym' ? 'proefles' : 'boeken'));
            const bookingTitle = h(spec.booking?.title || (industry === 'restaurant' ? 'Reserveren' : (industry === 'bakery' ? 'Bestellen' : 'Boeken')));
            const bookingSubtitle = h(spec.booking?.subtitle || 'Laat je gegevens achter, dan nemen we contact op.');

            const bookingSection = `
                <section class="section alt" id="${bookingId}">
                  <div class="wrap grid2">
                    <div class="reveal">
                      <div class="k">Direct regelen</div>
                      <h2>${bookingTitle}</h2>
                      <p>${bookingSubtitle}</p>
                      <ul class="checklist" style="margin-top: 1.2rem;">${featureList}</ul>
                    </div>
                    <div class="panel reveal">
                      <form class="form" data-demo="1">
                        <div class="f-row">
                          <div class="f">
                            <label>Naam</label>
                            <input required placeholder="Voornaam Achternaam" />
                          </div>
                          <div class="f">
                            <label>Telefoon</label>
                            <input required placeholder="06..." />
                          </div>
                        </div>
                        <div class="f-row">
                          <div class="f">
                            <label>E-mail</label>
                            <input type="email" required placeholder="${h(spec.email)}" />
                          </div>
                          <div class="f">
                            <label>${industry === 'restaurant' ? 'Aantal personen' : 'Voorkeur'}</label>
                            <select>
                              ${(industry === 'restaurant'
                                    ? ['2 personen','3 personen','4 personen','5 personen','6+ personen']
                                    : (industry === 'bakery' ? ['Afhalen','Catering','Vraag'] : ['Ochtend','Middag','Avond'])
                                ).map(x => `<option>${h(x)}</option>`).join('')}
                            </select>
                          </div>
                        </div>
                        <div class="f-row">
                          <div class="f">
                            <label>Datum</label>
                            <input type="date" required />
                          </div>
                          <div class="f">
                            <label>Tijd</label>
                            <input type="time" required />
                          </div>
                        </div>
                        <div class="f">
                          <label>Opmerking</label>
                          <textarea placeholder="Bijv. speciale wensen, behandeling, allergenen..."></textarea>
                        </div>
                        <button class="btn primary" type="submit">Versturen</button>
                        <div class="success" role="status" aria-live="polite" hidden>Bedankt. We bevestigen dit zo snel mogelijk.</div>
                      </form>
                    </div>
                  </div>
                </section>`;

            const contactSection = `
                <section class="section" id="contact">
                  <div class="wrap">
                    <div class="head">
                      <div class="k">Contact</div>
                      <h2>Plan een kort gesprek</h2>
                      <p>We reageren snel. Liever direct? Bel of mail ons, of stuur je vraag via het formulier.</p>
                    </div>
                    <div class="contact-grid">
                      <div class="panel reveal">
                        <form class="form" data-demo="1">
                          <div class="f-row">
                            <div class="f">
                              <label>Naam</label>
                              <input required placeholder="Naam" />
                            </div>
                            <div class="f">
                              <label>E-mail</label>
                              <input type="email" required placeholder="naam@bedrijf.nl" />
                            </div>
                          </div>
                          <div class="f">
                            <label>Bericht</label>
                            <textarea required placeholder="Waar kunnen we je mee helpen?"></textarea>
                          </div>
                          <button class="btn primary" type="submit">Verstuur bericht</button>
                          <div class="success" role="status" aria-live="polite" hidden>Bedankt. We nemen contact met je op.</div>
                        </form>
                      </div>
                      <div class="info reveal">
                        <div class="info-card">
                          <div class="info-ic">${icons.pin}</div>
                          <div>
                            <div class="info-l">Adres</div>
                            <div class="info-v">${h(spec.address)}</div>
                          </div>
                        </div>
                        <div class="info-card">
                          <div class="info-ic">${icons.chat}</div>
                          <div>
                            <div class="info-l">E-mail</div>
                            <div class="info-v"><a href="mailto:${h(spec.email)}">${h(spec.email)}</a></div>
                          </div>
                        </div>
                        <div class="info-card">
                          <div class="info-ic">${icons.cal}</div>
                          <div>
                            <div class="info-l">Telefoon</div>
                            <div class="info-v"><a href="tel:+31612345678">${h(spec.phone)}</a></div>
                          </div>
                        </div>
                        <div class="info-card">
                          <div class="info-ic">${icons.bolt}</div>
                          <div>
                            <div class="info-l">Openingstijden</div>
                            <div class="info-v">Ma-Vr 09:00-18:00<br/>Za 10:00-16:00</div>
                          </div>
                        </div>
                        <a class="btn ghost" href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(spec.address)}" target="_blank" rel="noopener">Open in Google Maps</a>
                      </div>
                    </div>
                  </div>
                </section>`;

		            const footerSocials = (spec.socials || []).map(s => `<a href="${s.href}">${h(s.label)}</a>`).join('');
		            const footerNav = (spec.nav || []).slice(0, 6).map(l => `<a href="${l.href}">${h(l.label)}</a>`).join('');

		            const pitch = spec.campaign || null;
		            const pitchId = String(pitch?.sectionId || 'belofte');
		            const pitchBullets = (pitch?.bullets || []).map(t => `<li><span class="li-ic">${icons.check}</span><span>${h(t)}</span></li>`).join('');
		            const pitchOfferItems = (pitch?.offer?.items || []).map(t => `<li><span class="li-ic">${icons.check}</span><span>${h(t)}</span></li>`).join('');
		            const pitchProof = (pitch?.proof || []).map(p => (
		                `<div class="proof"><div class="proof-v">${h(p.value)}</div><div class="proof-l">${h(p.label)}</div></div>`
		            )).join('');

		            const pitchMechTitle = pitch?.mechanism?.titleHtml || `${accentSpan('Helder')} in elke stap.`;
		            const pitchOfferTitle = pitch?.offer?.titleHtml || `Plan. ${accentSpan('Start')}.`;

		            const pitchSection = pitch ? `
		              <section class="section alt" id="${h(pitchId)}">
		                <div class="wrap">
		                  <div class="head">
		                    <div class="k">${h(pitch.kicker || 'Belofte')}</div>
		                    <h2>${pitch.headlineHtml || ''}</h2>
		                    <p>${h(pitch.subhead || '')}</p>
		                  </div>
		                  <div class="pitch-grid">
		                    <div class="panel reveal">
		                      <ul class="checklist">${pitchBullets}</ul>
		                      <div class="row" style="margin-top:1.4rem">${primaryCta}${secondaryCta}</div>
		                      ${pitch.note ? `<div class="hero-note">${h(pitch.note)}</div>` : ''}
		                    </div>
		                    <div class="pitch-stack">
		                      <article class="card reveal pitch-card">
		                        <div class="pitch-tag">${h(pitch.mechanism?.tag || 'Het systeem')}</div>
		                        <h3>${pitchMechTitle}</h3>
		                        <p>${h(pitch.mechanism?.desc || '')}</p>
		                      </article>
		                      <article class="card reveal pitch-card accent">
		                        <div class="pitch-tag">${h(pitch.offer?.tag || 'Aanbod')}</div>
		                        <h3>${pitchOfferTitle}</h3>
		                        <p>${h(pitch.offer?.desc || '')}</p>
		                        ${pitchOfferItems ? `<ul class="pitch-list">${pitchOfferItems}</ul>` : ''}
		                        ${pitchProof ? `<div class="pitch-proof">${pitchProof}</div>` : ''}
		                      </article>
		                    </div>
		                  </div>
		                </div>
		              </section>` : '';

			            const servicesK = industry === 'salon' ? 'Behandelingen' : 'Diensten';
			            const servicesH = industry === 'salon' ? 'Wat je boekt' : 'Wat we leveren';
			            const servicesP = (
		                industry === 'salon' ? 'Heldere kaart, rustige luxe en een snelle route naar online boeken.'
		                : industry === 'restaurant' ? 'Keuken, sfeer en service die klopt. Van reserveren tot dessert.'
		                : industry === 'gym' ? 'Training en coaching met een plan. Duidelijk, meetbaar en vol te houden.'
		                : industry === 'bakery' ? 'Elke dag vers uit de oven. Bestel online of loop binnen.'
		                : industry === 'interior' ? 'Van concept tot styling: een helder traject met oog voor detail.'
		                : 'Heldere diensten en een strakke route naar contact.'
		            );

	            const servicesSection = services ? `
	              <section class="section" id="diensten">
	                <div class="wrap">
	                  <div class="head">
	                    <div class="k">${h(servicesK)}</div>
	                    <h2>${h(servicesH)}</h2>
	                    <p>${h(servicesP)}</p>
	                  </div>
	                  <div class="grid3">${services}</div>
	                </div>
	              </section>` : '';

		            const pricingK = industry === 'gym' ? 'Tarieven' : 'Prijzen';
		            const pricingH = industry === 'gym' ? 'Abonnementen' : 'Pakketten';
		            const pricingP = (
		                industry === 'gym' ? 'Kies het niveau dat past bij jouw ritme. Upgrade of pauzeer wanneer nodig.'
		                : industry === 'salon' ? 'Heldere tarieven. Voor kleur en balayage plannen we kort advies vooraf.'
		                : industry === 'restaurant' ? 'Menu-opties voor elk moment. Vraag naar wisselende specials.'
		                : industry === 'bakery' ? 'Voor afhalen en maatwerk. Voor custom taarten maken we een voorstel.'
		                : industry === 'interior' ? 'Transparant per fase, van concept tot oplevering. Geen verrassingen.'
		                : 'Heldere pakketten. Kies nu, schaal later op.'
		            );

	            const pricingSection = pricing ? `
	              <section class="section alt" id="prijzen">
	                <div class="wrap">
	                  <div class="head">
	                    <div class="k">${h(pricingK)}</div>
	                    <h2>${h(pricingH)}</h2>
	                    <p>${h(pricingP)}</p>
	                  </div>
	                  <div class="price-grid">${pricing}</div>
	                </div>
	              </section>` : '';

	            const teamSection = team ? `
	              <section class="section" id="${teamSectionId}">
	                <div class="wrap">
	                  <div class="head">
	                    <div class="k">${h(teamKicker)}</div>
	                    <h2>${h(teamTitle)}</h2>
	                    <p>${h(teamText)}</p>
	                  </div>
	                  <div class="people">${team}</div>
	                </div>
	              </section>` : '';

	            const galleryK = industry === 'interior' ? 'Projectbeelden' : 'Galerie';
	            const galleryH = industry === 'interior' ? 'Sfeer & Details' : 'Sfeer & Resultaat';
	            const galleryP = industry === 'interior'
	                ? 'Premium fotografie en een strakke grid-layout: detail, licht en materiaal.'
	                : 'Premium fotografie en een strakke grid-layout, geoptimaliseerd voor snelheid.';

	            const gallerySection = gallery ? `
	              <section class="section alt" id="galerie">
	                <div class="wrap">
	                  <div class="head">
	                    <div class="k">${h(galleryK)}</div>
	                    <h2>${h(galleryH)}</h2>
	                    <p>${h(galleryP)}</p>
	                  </div>
	                  <div class="gallery">${gallery}</div>
	                </div>
	              </section>` : '';

	            const reviewsSection = testimonials ? `
	              <section class="section" id="reviews">
	                <div class="wrap">
	                  <div class="head">
	                    <div class="k">Reviews</div>
	                    <h2>Wat klanten zeggen</h2>
	                    <p>Korte quotes die vertrouwen opbouwen en conversie verhogen.</p>
	                  </div>
	                  <div class="quote-grid">${testimonials}</div>
	                </div>
	              </section>` : '';

		            const faqSection = faq ? `
		              <section class="section alt" id="faq">
		                <div class="wrap">
		                  <div class="head">
		                    <div class="k">FAQ</div>
		                    <h2>Veelgestelde vragen</h2>
		                    <p>Snelle antwoorden. Helpt twijfel weg te nemen en verhoogt conversie.</p>
		                  </div>
		                  <div class="faq">${faq}</div>
		                </div>
		              </section>` : '';

		            const blocks = {
		                pitch: pitchSection,
		                menu: menuSection,
		                projects: projectsSection,
		                process: processSection,
		                beforeAfter: beforeAfterSection,
		                services: servicesSection,
	                pricing: pricingSection,
	                team: teamSection,
	                assortment: assortmentSection,
	                gallery: gallerySection,
	                story: story,
	                reviews: reviewsSection,
	                schedule: scheduleSection,
	                booking: bookingSection,
		                faq: faqSection,
		                contact: contactSection
		            };

		            const defaultOrder = ['menu','projects','process','beforeAfter','services','pricing','team','assortment','gallery','story','reviews','schedule','booking','faq','contact'];
		            const orderBase = Array.isArray(arch?.order) ? arch.order : defaultOrder;
		            const order = orderBase.includes('pitch') ? orderBase : ['pitch'].concat(orderBase);
		            const seen = new Set();
		            const finalOrder = [];
		            order.forEach((k) => { if (!seen.has(k)) { seen.add(k); finalOrder.push(k); } });
		            if (!seen.has('contact')) finalOrder.push('contact');
		            const mainSections = finalOrder.map(k => blocks[k]).filter(Boolean).join('');

	            // SEO structured data (LocalBusiness)
	            const schema = {
	                '@context': 'https://schema.org',
                '@type': 'LocalBusiness',
                name: spec.brand,
                address: { '@type': 'PostalAddress', streetAddress: spec.address, addressLocality: rawLocation || spec.location, addressCountry: 'NL' },
                telephone: spec.phone,
                email: spec.email,
                url: 'https://example.com'
            };

            const themeBg = `radial-gradient(circle at 15% 0%, ${accentGlow}, transparent 45%), radial-gradient(circle at 95% 5%, ${accentGlow2}, transparent 40%), #f8f7f4`;
            const closeScript = '</scr' + 'ipt>';
            const safeSchemaJson = JSON.stringify(schema).replace(/</g, '\\u003c');

            return `<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>${pageTitle}</title>
  <meta name="description" content="${metaDescription}" />
  <meta property="og:title" content="${pageTitle}" />
  <meta property="og:description" content="${metaDescription}" />
  <meta property="og:type" content="website" />
	  <meta name="theme-color" content="${h(spec.accent)}" />
	  <link rel="preconnect" href="https://fonts.googleapis.com" />
	  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
	  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Oswald:wght@400;500;600;700&display=swap" rel="stylesheet" />
	  <script type="application/ld+json">${safeSchemaJson}${closeScript}
	  <style>
	    * { margin: 0; padding: 0; box-sizing: border-box; }
	    :root{
      --bg: #f8f7f4;
      --surface: #ffffff;
      --surface-2: #efeee9;
      --text: #1a1a2e;
      --muted: #6b6b7b;
      --muted-2: #a0a0b0;
      --border: rgba(0,0,0,0.08);
      --accent: ${h(spec.accent)};
      --accent2: ${h(spec.accent2)};
      --glow: ${accentGlow};
      --ease: cubic-bezier(0.16, 1, 0.3, 1);
      --clip: polygon(0 0, calc(100% - 18px) 0, 100% 18px, 100% 100%, 18px 100%, 0 calc(100% - 18px));
    }
    html{scroll-behavior:smooth}
    body{
      font-family: Inter, system-ui, -apple-system, Segoe UI, sans-serif;
      background: ${themeBg};
      color: var(--text);
      line-height: 1.6;
    }
    img{display:block; max-width:100%}
    a{color:inherit}
    h1,h2,h3{
      font-family: Oswald, system-ui, sans-serif;
      text-transform: uppercase;
      letter-spacing: 0.02em;
      line-height: 1;
    }
    .wrap{width:min(1180px,92vw); margin:0 auto}
    .nav{
      position: sticky; top:0; z-index:50;
      background: rgba(248,247,244,0.86);
      border-bottom: 1px solid var(--border);
      backdrop-filter: blur(16px);
    }
    .nav-inner{
      display:flex; align-items:center; justify-content:space-between;
      padding: 1.15rem 0;
      gap: 1rem;
    }
    .brand{
      text-decoration:none;
      font-family: Oswald, system-ui, sans-serif;
      font-weight: 700;
      letter-spacing: -0.02em;
      font-size: 1.5rem;
    }
    .brand .dot{color:var(--accent)}
    .links{display:flex; align-items:center; gap:1.25rem}
    .links a{
      text-decoration:none;
      font-family: Oswald, system-ui, sans-serif;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      font-size: 0.78rem;
      color: var(--muted);
      border-bottom: 2px solid transparent;
      padding: 0.35rem 0;
      transition: all .25s var(--ease);
      white-space: nowrap;
    }
    .links a:hover{color:var(--text); border-bottom-color: var(--accent)}
    .nav-cta{display:flex; gap:.7rem; align-items:center}
    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      padding: .95rem 1.2rem;
      border: 1px solid var(--border);
      background: var(--surface);
      color: var(--text);
      text-decoration:none;
      font-family: Oswald, system-ui, sans-serif;
      letter-spacing: .14em;
      text-transform: uppercase;
      font-size: .78rem;
      transition: all .25s var(--ease);
      clip-path: polygon(0 0, calc(100% - 14px) 0, 100% 14px, 100% 100%, 0 100%);
      white-space: nowrap;
    }
    .btn:hover{border-color: rgba(0,0,0,0.18); transform: translateY(-1px)}
    .btn.primary{
      background: var(--accent);
      border-color: var(--accent);
      color:#fff;
      box-shadow: 0 0 0 rgba(0,0,0,0);
    }
    .btn.primary:hover{
      background: var(--accent2);
      border-color: var(--accent2);
      box-shadow: 0 0 45px var(--glow);
    }
    .btn.ghost{
      background: transparent;
      border-color: rgba(0,0,0,0.14);
      color: var(--text);
    }
    .btn.ghost:hover{
      border-color: rgba(0,0,0,0.22);
      background: rgba(0,0,0,0.02);
    }
    .hero{padding: 5.2rem 0 2.8rem; position:relative; overflow:hidden}
    .hero-grid{
      display:grid;
      grid-template-columns: 1.15fr 0.85fr;
      gap: 2.2rem;
      align-items: center;
    }
    .k{
      font-family: Oswald, system-ui, sans-serif;
      letter-spacing: .18em;
      text-transform: uppercase;
      color: var(--muted-2);
      font-size: .75rem;
      margin-bottom: 1.1rem;
    }
	    .hero h1{font-size: clamp(2.8rem, 6vw, 5.6rem); margin-bottom: 1rem}
	    .accent{color: var(--accent)}
	    .hero p{color: var(--muted); font-weight: 300; font-size: 1.05rem; max-width: 62ch}
	    .row{display:flex; gap:.9rem; flex-wrap:wrap; margin-top:1.8rem}
	    .hero-note{
	      margin-top: 1rem;
	      color: var(--muted);
	      font-weight: 300;
	      font-size: .92rem;
	      max-width: 62ch;
	    }
	    .hero-media{
	      border: 1px solid var(--border);
	      background: var(--surface);
	      clip-path: var(--clip);
	      overflow:hidden;
      position:relative;
      box-shadow: 0 16px 50px rgba(0,0,0,0.06);
    }
    .hero-media img{
      width:100%;
      height: 440px;
      object-fit: cover;
      filter: contrast(1.05) brightness(0.98);
      transform: scale(1.02);
    }
	    .hero-media::after{
	      content:'';
	      position:absolute;
	      inset:0;
	      background: linear-gradient(to top, rgba(0,0,0,0.32), transparent 55%);
	      pointer-events:none;
	    }
	    .pills{display:flex; flex-wrap:wrap; gap:.55rem; margin-top: 1.4rem}
	    .pill{
	      display:inline-flex; align-items:center; gap:.45rem;
	      padding:.45rem .75rem;
	      border:1px solid var(--border);
	      background: rgba(255,255,255,0.75);
	      backdrop-filter: blur(10px);
	      clip-path: polygon(0 0, calc(100% - 12px) 0, 100% 12px, 100% 100%, 0 100%);
	      font-family: Oswald, system-ui, sans-serif;
	      text-transform: uppercase;
	      letter-spacing: .14em;
	      font-size: .68rem;
	      color: var(--text);
	    }
	    .pill svg{width: 16px; height: 16px; opacity: .85; flex-shrink: 0}
	    .mini-grid{display:grid; grid-template-columns: repeat(3, 1fr); gap: .65rem}
	    .mini-grid.on-media{
	      position:absolute;
	      left: 1rem;
	      right: 1rem;
	      bottom: 1rem;
	    }
	    .mini-grid.on-copy{
	      display:none;
	      margin-top: 1.35rem;
	      grid-template-columns: repeat(3, minmax(0, 1fr));
	    }
    .mini{
      background: rgba(255,255,255,0.82);
      border: 1px solid rgba(255,255,255,0.6);
      padding: .85rem .9rem;
      backdrop-filter: blur(10px);
      clip-path: polygon(0 0, calc(100% - 12px) 0, 100% 12px, 100% 100%, 0 100%);
    }
    .mini-v{
      font-family: Oswald, system-ui, sans-serif;
      font-weight: 700;
      letter-spacing: .02em;
      font-size: 1.35rem;
      line-height: 1;
    }
    .mini-l{
      color: rgba(26,26,46,0.65);
      font-size: .75rem;
      margin-top: .25rem;
      letter-spacing: .08em;
      text-transform: uppercase;
      font-family: Oswald, system-ui, sans-serif;
    }
    .section{padding: 4.2rem 0}
    .section.alt{background: rgba(255,255,255,0.55); border-top: 1px solid var(--border); border-bottom: 1px solid var(--border)}
    .head{margin-bottom: 1.8rem}
    .head h2{font-size: clamp(2rem, 3.5vw, 3rem)}
    .head p{color: var(--muted); font-weight: 300; max-width: 70ch; margin-top: .9rem}
	    .grid3{display:grid; grid-template-columns: repeat(3, 1fr); gap: 1.1rem; margin-top: 1.6rem}
	    .grid2{display:grid; grid-template-columns: 1fr 1fr; gap: 1.6rem; align-items: center}
	    .pitch-grid{display:grid; grid-template-columns: 1.05fr 0.95fr; gap: 1.1rem; align-items: start; margin-top: 1.7rem}
	    .pitch-stack{display:grid; gap: 1.1rem}
	    .pitch-tag{
	      display:inline-flex; align-items:center; gap:.5rem;
	      font-family: Oswald, system-ui, sans-serif;
	      text-transform: uppercase;
	      letter-spacing: .14em;
	      font-size: .7rem;
	      color: var(--muted-2);
	      border: 1px solid var(--border);
	      background: rgba(0,0,0,0.02);
	      padding: .35rem .6rem;
	      margin-bottom: .85rem;
	      clip-path: polygon(0 0, calc(100% - 12px) 0, 100% 12px, 100% 100%, 0 100%);
	    }
	    .pitch-card.accent{border-color: rgba(0,0,0,0.16)}
	    .pitch-card.accent .pitch-tag{color: var(--accent); border-color: rgba(0,0,0,0.16); background: rgba(0,0,0,0.03)}
	    .pitch-list{list-style:none; display:grid; gap:.65rem; margin-top: .9rem}
	    .pitch-list li{display:flex; gap:.7rem; align-items:flex-start; color: var(--muted); font-weight:300}
	    .pitch-proof{display:grid; grid-template-columns: repeat(3, 1fr); gap:.65rem; margin-top: 1.1rem}
	    .proof{
	      border: 1px solid var(--border);
	      background: var(--bg);
	      padding: .85rem .9rem;
	      clip-path: polygon(0 0, calc(100% - 12px) 0, 100% 12px, 100% 100%, 0 100%);
	    }
	    .proof-v{
	      font-family: Oswald, system-ui, sans-serif;
	      font-weight: 700;
	      letter-spacing: .02em;
	      font-size: 1.35rem;
	      line-height: 1;
	    }
	    .proof-l{
	      color: var(--muted-2);
	      font-size: .72rem;
	      margin-top: .25rem;
	      letter-spacing: .12em;
	      text-transform: uppercase;
	      font-family: Oswald, system-ui, sans-serif;
	    }
	    .card{
	      border: 1px solid var(--border);
	      background: var(--surface);
	      padding: 1.8rem;
	      clip-path: var(--clip);
      box-shadow: 0 2px 10px rgba(0,0,0,0.02);
      transition: all .25s var(--ease);
      position: relative;
      overflow:hidden;
    }
    .card::before{
      content:'';
      position:absolute;
      inset:0;
      background: linear-gradient(135deg, rgba(0,0,0,0.0), ${accentGlow} 120%);
      opacity: 0;
      transition: opacity .25s var(--ease);
      pointer-events:none;
    }
    .card:hover{transform: translateY(-3px); border-color: rgba(0,0,0,0.16); box-shadow: 0 12px 30px rgba(0,0,0,0.06)}
    .card:hover::before{opacity: 1}
    .card h3{font-size: 1.15rem; margin-bottom: .6rem}
    .card p{color: var(--muted); font-weight: 300; font-size: .95rem}
    .icon{
      width: 42px; height: 42px;
      display:flex; align-items:center; justify-content:center;
      background: rgba(0,0,0,0.03);
      border: 1px solid var(--border);
      margin-bottom: 1.1rem;
      color: var(--accent);
    }
    .icon svg{width: 22px; height: 22px}
    .media{
      border: 1px solid var(--border);
      clip-path: var(--clip);
      overflow:hidden;
      background: var(--surface);
      box-shadow: 0 12px 35px rgba(0,0,0,0.05);
    }
    .media img{width:100%; height: 520px; object-fit: cover}
    .gallery{display:grid; grid-template-columns: repeat(12, 1fr); gap: .9rem; margin-top: 1.7rem}
    .g-item{grid-column: span 4; border:1px solid var(--border); background:var(--surface); clip-path: var(--clip); overflow:hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.02)}
    .g-item img{width:100%; height: 220px; object-fit: cover}
    .checklist{list-style:none; display:grid; gap:.65rem}
    .checklist li{display:flex; gap:.7rem; align-items:flex-start; color: var(--muted); font-weight:300}
    .li-ic{width:18px; height:18px; margin-top:.15rem; color: var(--accent)}
    .li-ic svg{width:18px; height:18px}
    .price-grid{display:grid; grid-template-columns: repeat(3, 1fr); gap: 1.1rem; margin-top: 1.7rem}
    .price-card{border:1px solid var(--border); background: var(--surface); padding: 2rem; clip-path: var(--clip); position:relative; overflow:hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.02)}
    .price-card.featured{border-color: rgba(0,0,0,0.18); box-shadow: 0 22px 60px rgba(0,0,0,0.08)}
    .badge{position:absolute; top:0; right:0; background: var(--accent); color:#fff; font-family: Oswald, system-ui, sans-serif; letter-spacing: .12em; text-transform: uppercase; font-size: .72rem; padding: .55rem 1.2rem; clip-path: polygon(0 0, 100% 0, 100% 100%, 14% 100%)}
    .p-name{font-family: Oswald, system-ui, sans-serif; letter-spacing:.12em; text-transform: uppercase; color: var(--muted-2); font-size: .75rem}
    .p-price{font-family: Oswald, system-ui, sans-serif; font-size: 3.1rem; line-height:1; margin: .8rem 0 .35rem}
    .p-note{color: var(--muted); font-weight: 300; margin-bottom: 1.1rem}
    .p-list{list-style:none; display:grid; gap:.55rem; color: var(--muted); font-weight:300; margin: 1.1rem 0 1.6rem}
    .p-list li{padding-left: 1rem; position:relative}
    .p-list li::before{content:'›'; position:absolute; left:0; color: var(--accent); font-weight:700}
    .quote-grid{display:grid; grid-template-columns: repeat(3, 1fr); gap: 1.1rem; margin-top: 1.7rem}
    .quote{border:1px solid var(--border); background: var(--surface); padding: 1.8rem; clip-path: var(--clip); box-shadow: 0 2px 10px rgba(0,0,0,0.02)}
    .quote p{color: var(--muted); font-weight:300}
    .who{margin-top: .9rem; font-family: Oswald, system-ui, sans-serif; text-transform: uppercase; letter-spacing: .12em; font-size: .75rem}
    .faq{display:grid; gap:.8rem; margin-top: 1.4rem}
    .faq-item{border:1px solid var(--border); background: var(--surface); clip-path: var(--clip); overflow:hidden}
    .faq-item summary{cursor:pointer; list-style:none; padding: 1.1rem 1.3rem; font-family: Oswald, system-ui, sans-serif; letter-spacing:.08em; text-transform: uppercase; font-size: .92rem}
    .faq-item summary::-webkit-details-marker{display:none}
    .faq-a{padding: 0 1.3rem 1.2rem}
    .faq-a p{color: var(--muted); font-weight:300}
    .panel{border:1px solid var(--border); background: var(--surface); padding: 2rem; clip-path: var(--clip); box-shadow: 0 2px 10px rgba(0,0,0,0.02)}
    .form{display:grid; gap: 1rem}
    .f-row{display:grid; grid-template-columns: 1fr 1fr; gap: 1rem}
    .f label{display:block; font-family: Oswald, system-ui, sans-serif; font-size: .72rem; text-transform: uppercase; letter-spacing: .16em; color: var(--muted-2); margin-bottom: .55rem}
    .f input,.f select,.f textarea{
      width:100%;
      padding: .95rem 1.05rem;
      border: 2px solid var(--border);
      background: var(--bg);
      outline:none;
      font: inherit;
      color: var(--text);
      transition: all .25s var(--ease);
    }
    .f textarea{min-height: 120px; resize: vertical; line-height:1.7}
    .f input:focus,.f select:focus,.f textarea:focus{border-color: var(--accent); background: var(--surface); box-shadow: 0 0 0 4px ${accentGlow2}}
    .success{margin-top:.5rem; color: var(--accent); font-weight: 500}
    .contact-grid{display:grid; grid-template-columns: 1.1fr 0.9fr; gap: 1.1rem; margin-top: 1.7rem; align-items: start}
    .info{display:grid; gap: .9rem}
    .info-card{
      display:flex; gap: .9rem; align-items:flex-start;
      border: 1px solid var(--border);
      background: var(--surface);
      padding: 1.2rem 1.25rem;
      clip-path: polygon(0 0, calc(100% - 14px) 0, 100% 14px, 100% 100%, 0 100%);
    }
    .info-ic{width: 38px; height: 38px; border:1px solid var(--border); display:flex; align-items:center; justify-content:center; color: var(--accent); background: rgba(0,0,0,0.03)}
    .info-ic svg{width: 20px; height: 20px}
    .info-l{font-family: Oswald, system-ui, sans-serif; font-size: .7rem; text-transform: uppercase; letter-spacing: .16em; color: var(--muted-2)}
    .info-v{margin-top: .25rem; color: var(--muted); font-weight: 300}
    .people{display:grid; grid-template-columns: repeat(3, 1fr); gap: 1.1rem; margin-top: 1.7rem}
    .person{border:1px solid var(--border); background: var(--surface); clip-path: var(--clip); overflow:hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.02)}
    .person-img img{width:100%; height: 260px; object-fit: cover}
    .person-body{padding: 1.2rem 1.25rem}
    .person-name{font-family: Oswald, system-ui, sans-serif; text-transform: uppercase; letter-spacing: .06em}
    .person-role{color: var(--muted); font-weight:300; margin-top: .25rem}
    .menu-grid{display:grid; grid-template-columns: repeat(3, 1fr); gap: 1.1rem; margin-top: 1.7rem}
    .menu-cat{border:1px solid var(--border); background: var(--surface); padding: 1.7rem; clip-path: var(--clip); box-shadow: 0 2px 10px rgba(0,0,0,0.02)}
    .menu-title{font-family: Oswald, system-ui, sans-serif; letter-spacing:.14em; text-transform: uppercase; font-size: .8rem; color: var(--muted-2); margin-bottom: 1rem}
    .menu-items{display:grid; gap: .85rem}
    .menu-item{display:grid; grid-template-columns: 1fr auto; gap: .35rem .8rem; padding-bottom: .85rem; border-bottom: 1px solid var(--border)}
    .menu-item:last-child{border-bottom:none; padding-bottom:0}
    .menu-name{font-weight: 600}
    .menu-price{font-family: Oswald, system-ui, sans-serif; letter-spacing:.06em}
    .menu-desc{grid-column: 1 / -1; color: var(--muted); font-weight: 300; font-size: .92rem}
    .schedule{display:grid; grid-template-columns: repeat(7, 1fr); gap: .9rem; margin-top: 1.7rem}
    .day{border:1px solid var(--border); background: var(--surface); padding: 1.1rem; clip-path: polygon(0 0, calc(100% - 14px) 0, 100% 14px, 100% 100%, 0 100%); box-shadow: 0 2px 10px rgba(0,0,0,0.02)}
    .day-h{font-family: Oswald, system-ui, sans-serif; text-transform: uppercase; letter-spacing:.14em; font-size: .75rem; color: var(--muted-2); margin-bottom: .7rem}
    .day-b{display:grid; gap:.5rem}
    .day-b span{display:block; padding:.35rem .45rem; border: 1px solid var(--border); background: var(--bg); font-size: .82rem; color: var(--muted)}
    .proj-grid{display:grid; grid-template-columns: repeat(3, 1fr); gap: 1.1rem; margin-top: 1.7rem}
    .proj{border:1px solid var(--border); background: var(--surface); clip-path: var(--clip); overflow:hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.02)}
    .proj-img img{width:100%; height: 230px; object-fit: cover}
    .proj-body{padding: 1.2rem 1.25rem}
    .tag{display:inline-flex; align-items:center; padding:.35rem .75rem; border:1px solid var(--border); color: var(--muted-2); font-family: Oswald, system-ui, sans-serif; letter-spacing:.12em; text-transform: uppercase; font-size: .7rem; margin-bottom: .8rem}
    .proj-body p{color: var(--muted); font-weight: 300; margin-top: .5rem}
    .prod-grid{display:grid; grid-template-columns: repeat(3, 1fr); gap: 1.1rem; margin-top: 1.7rem}
    .prod{border:1px solid var(--border); background: var(--surface); clip-path: var(--clip); overflow:hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.02)}
    .prod-img img{width:100%; height: 230px; object-fit: cover}
    .prod-body{padding: 1.1rem 1.25rem}
    .prod-row{display:flex; justify-content:space-between; align-items:flex-end; gap: .8rem}
    .prod-price{font-family: Oswald, system-ui, sans-serif; letter-spacing:.04em}
    .ba{position:relative; border:1px solid var(--border); background: var(--surface); clip-path: var(--clip); overflow:hidden; box-shadow: 0 12px 35px rgba(0,0,0,0.06)}
    .ba-img{width:100%; height: 480px; object-fit: cover}
    .ba-top{position:absolute; left:0; top:0; height:100%; width:50%; overflow:hidden}
    .ba-handle{position:absolute; top:0; left: calc(50% - 10px); width: 20px; height:100%; background: rgba(255,255,255,0.35); backdrop-filter: blur(8px); border-left: 1px solid rgba(255,255,255,0.7); border-right: 1px solid rgba(255,255,255,0.7)}
    .ba-range{position:absolute; left: 1rem; right: 1rem; bottom: 1rem}
    .footer{padding: 3.2rem 0; border-top: 1px solid var(--border); background: rgba(255,255,255,0.75)}
    .footer-grid{display:grid; grid-template-columns: 2fr 1fr 1fr; gap: 2rem}
    .footer h3{font-size: 1.2rem}
    .footer p{color: var(--muted); font-weight:300; margin-top:.8rem; max-width: 44ch}
    .footer a{display:block; color: var(--muted); text-decoration:none; margin-top:.55rem}
    .footer a:hover{color: var(--text)}
    .foot-bottom{margin-top: 2.2rem; padding-top: 1.2rem; border-top: 1px solid var(--border); color: var(--muted-2); font-size: .85rem}
    .reveal{opacity: 0; transform: translateY(18px); transition: all .7s var(--ease)}
    .reveal.in{opacity:1; transform: translateY(0)}

    /* Archetypes (make each build feel like a different premium art direction) */
    body{position:relative}
    header, main, footer{position:relative; z-index: 1}
    .hero-copy{position:relative; z-index: 2}

    body[data-arch="grid"]::before{
      content:'';
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
      opacity: .22;
      background-image:
        linear-gradient(to right, rgba(0,0,0,0.06) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(0,0,0,0.06) 1px, transparent 1px);
      background-size: 84px 84px;
      mix-blend-mode: multiply;
    }

    body[data-arch="nebula"]{
      background:
        radial-gradient(circle at 18% 5%, ${accentGlow}, transparent 45%),
        radial-gradient(circle at 92% 12%, ${accentGlow2}, transparent 42%),
        radial-gradient(circle at 60% 110%, rgba(0,0,0,0.04), transparent 55%),
        #f8f7f4;
    }
    body[data-arch="nebula"] .card,
    body[data-arch="nebula"] .panel,
    body[data-arch="nebula"] .hero-media,
    body[data-arch="nebula"] .menu-cat,
    body[data-arch="nebula"] .price-card,
    body[data-arch="nebula"] .info-card{
      background: rgba(255,255,255,0.70);
      backdrop-filter: blur(18px);
    }
    body[data-arch="nebula"] .pill{background: rgba(255,255,255,0.55)}

    body[data-arch="editorial"] .btn,
    body[data-arch="editorial"] .card,
    body[data-arch="editorial"] .hero-media,
    body[data-arch="editorial"] .media,
    body[data-arch="editorial"] .g-item,
    body[data-arch="editorial"] .person,
    body[data-arch="editorial"] .proj,
    body[data-arch="editorial"] .prod,
    body[data-arch="editorial"] .price-card,
    body[data-arch="editorial"] .menu-cat,
    body[data-arch="editorial"] .day,
    body[data-arch="editorial"] .ba,
    body[data-arch="editorial"] .info-card{
      clip-path: none;
      border-radius: 18px;
    }
    body[data-arch="editorial"] .btn{border-radius: 999px; padding: .95rem 1.4rem; clip-path: none}
    body[data-arch="editorial"] .head{
      display:grid;
      grid-template-columns: 0.95fr 1.05fr;
      gap: 1.6rem;
      align-items: end;
    }
    body[data-arch="editorial"] .head p{margin-top: 0; max-width: none}
	    body[data-arch="editorial"] .hero h1{letter-spacing:-0.01em}
	    body[data-arch="editorial"] .section{padding: 5.2rem 0}
	    body[data-arch="editorial"] .section.alt{background: transparent}

	    body[data-arch="poster"] .k{color: var(--accent)}
	    body[data-arch="poster"] .hero h1{
	      font-size: clamp(3.2rem, 7.6vw, 7.4rem);
	      letter-spacing: -0.02em;
	    }
	    @supports (-webkit-background-clip: text){
	      body[data-arch="poster"] .accent{
	        background: linear-gradient(90deg, var(--accent), var(--accent2));
	        -webkit-background-clip: text;
	        -webkit-text-fill-color: transparent;
	      }
	    }
	    body[data-arch="poster"] .section.alt{background: rgba(0,0,0,0.015)}
	    body[data-arch="poster"] .hero-media::after{
	      background:
	        linear-gradient(to top, rgba(248,247,244,0.92), transparent 55%),
	        radial-gradient(circle at 22% 70%, ${accentGlow}, transparent 58%);
	    }

	    body[data-arch="brutal"] .btn,
	    body[data-arch="brutal"] .card,
	    body[data-arch="brutal"] .hero-media,
	    body[data-arch="brutal"] .media,
	    body[data-arch="brutal"] .g-item,
	    body[data-arch="brutal"] .person,
	    body[data-arch="brutal"] .proj,
	    body[data-arch="brutal"] .prod,
	    body[data-arch="brutal"] .price-card,
	    body[data-arch="brutal"] .menu-cat,
	    body[data-arch="brutal"] .day,
	    body[data-arch="brutal"] .ba,
	    body[data-arch="brutal"] .info-card{
	      clip-path: none;
	      border-radius: 0;
	      border-width: 2px;
	      box-shadow: none;
	    }
	    body[data-arch="brutal"] .section.alt{background: rgba(255,255,255,0.92)}
	    body[data-arch="brutal"] .pill{background: rgba(255,255,255,0.86); border-color: rgba(0,0,0,0.14)}
	    body[data-arch="brutal"] .mini{background: rgba(255,255,255,0.86); border-color: rgba(0,0,0,0.14)}

	    body[data-arch="cinema"] .hero{padding: 0; min-height: 92vh}
	    body[data-arch="cinema"] .hero-grid{
	      grid-template-columns: 1fr;
	      padding: 7.6rem 0 3.4rem;
      min-height: 92vh;
      align-items: end;
    }
    body[data-arch="cinema"] .hero-media{
      position:absolute;
      inset:0;
      clip-path: none;
      border: none;
      background: transparent;
      box-shadow: none;
    }
    body[data-arch="cinema"] .hero-media img{
      height: 100%;
      min-height: 92vh;
      filter: contrast(1.08) brightness(0.72);
      transform: none;
    }
    body[data-arch="cinema"] .hero-media::after{
      background:
        linear-gradient(90deg, rgba(248,247,244,0.96) 0%, rgba(248,247,244,0.80) 38%, rgba(248,247,244,0.18) 72%, rgba(248,247,244,0.06) 100%),
        linear-gradient(to top, rgba(248,247,244,0.92), transparent 60%);
    }
    body[data-arch="cinema"] .mini-grid.on-media{display:none}
    body[data-arch="cinema"] .mini-grid.on-copy{display:grid}
    body[data-arch="cinema"] .pill{background: rgba(255,255,255,0.68)}
	    @media (max-width: 980px){
	      .hero-grid{grid-template-columns: 1fr}
	      .pitch-grid{grid-template-columns: 1fr}
	      .links{display:none}
	      .price-grid,.grid3,.quote-grid,.people,.proj-grid,.prod-grid{grid-template-columns: 1fr}
	      .gallery{grid-template-columns: 1fr}
	      .g-item{grid-column: span 12}
	      .menu-grid{grid-template-columns: 1fr}
      .schedule{grid-template-columns: 1fr}
      .contact-grid{grid-template-columns: 1fr}
      .media img{height: 360px}
      .ba-img{height: 360px}
      .f-row{grid-template-columns: 1fr}
      .footer-grid{grid-template-columns: 1fr}
    }
    @media (prefers-reduced-motion: reduce){
      html{scroll-behavior:auto}
      .reveal{transition:none}
      .btn{transition:none}
    }
  </style>
</head>
<body data-arch="${h(archId)}" data-industry="${h(industry)}">
  <header class="nav">
    <div class="wrap nav-inner">
      <a class="brand" href="#top">${h(spec.brand)}<span class="dot">.</span></a>
      <nav class="links" aria-label="Navigatie">${navLinks}</nav>
      <div class="nav-cta">${primaryCta}</div>
    </div>
  </header>

  <main id="top">
	    <section class="hero">
	      <div class="wrap hero-grid">
		        <div class="hero-copy">
		          <div class="k">${h(spec.hero?.kicker || spec.location)}</div>
		          <h1>${spec.hero?.title || ''}</h1>
		          <p>${h(spec.hero?.subtitle || rawDesc || '')}</p>
		          <div class="row">${primaryCta}${secondaryCta}</div>
		          ${heroNote}
		          ${heroPillsWrap}
		          ${heroStatsCopy}
		        </div>
	        <aside class="hero-media reveal">
	          <img src="${img(spec.hero?.image, 1600, 1100)}" alt="${h(spec.bizType)} sfeerbeeld" loading="eager" decoding="async" fetchpriority="high" />
	          ${heroStatsMedia}
	        </aside>
	      </div>
	    </section>

	    ${mainSections}
	  </main>

  <footer class="footer">
    <div class="wrap footer-grid">
      <div>
        <h3>${h(spec.brand)}<span class="accent">.</span></h3>
        <p>${h(spec.bizType)} in ${h(spec.location)}. Premium uitstraling, duidelijke structuur en focus op resultaat.</p>
      </div>
      <div>
        <div class="k">Navigatie</div>
        ${footerNav}
      </div>
      <div>
        <div class="k">Volg ons</div>
        ${footerSocials}
      </div>
    </div>
    <div class="wrap foot-bottom">© ${new Date().getFullYear()} ${h(spec.brand)}</div>
  </footer>

	  <script>
	    (function () {
      const io = new IntersectionObserver((entries) => {
        entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('in'); });
      }, { threshold: 0.12 });
      document.querySelectorAll('.reveal').forEach(el => io.observe(el));

      document.querySelectorAll('a[href^=\"#\"]').forEach(a => {
        a.addEventListener('click', (e) => {
          const id = a.getAttribute('href');
          const t = document.querySelector(id);
          if (!t) return;
          e.preventDefault();
          t.scrollIntoView({ behavior: 'smooth', block: 'start' });
        });
      });

      document.querySelectorAll('form[data-demo]').forEach(form => {
        form.addEventListener('submit', (e) => {
          e.preventDefault();
          const ok = form.querySelector('.success');
          if (ok) ok.hidden = false;
          form.reset();
        });
      });

      const range = document.getElementById('baRange');
      const top = document.getElementById('baTop');
      const handle = document.getElementById('baHandle');
      if (range && top && handle) {
        const apply = () => {
          const v = Number(range.value) || 50;
          top.style.width = v + '%';
          handle.style.left = 'calc(' + v + '% - 10px)';
        };
        range.addEventListener('input', apply);
        apply();
      }
	    })();
	  ${closeScript}
</body>
</html>`;
        }

        function scorePreviewHtml(html, meta) {
            const source = String(html || '');
            if (!source) return -Infinity;

            const lower = source.toLowerCase();
            const sectionCount = (source.match(/<section\b/g) || []).length;
            const imageCount = (source.match(/<img\b/g) || []).length;
            const buttonCount = (source.match(/class=\"[^\"]*btn/g) || []).length;
            const ctaWords = (lower.match(/plan|contact|offerte|boek|intake|start project|afspraak/g) || []).length;
            const wordSet = new Set((lower.match(/[a-zà-ÿ]{5,}/g) || []).slice(0, 3000));

            let score = 0;
            score += Math.min(40, source.length / 650);
            score += Math.min(20, sectionCount * 2.4);
            score += Math.min(18, imageCount * 2.8);
            score += Math.min(10, buttonCount * 1.2);
            score += Math.min(10, ctaWords * 0.9);
            score += Math.min(12, wordSet.size / 120);

            const target = String(meta?.title || '').toLowerCase();
            if (target && lower.includes(target.slice(0, Math.min(18, target.length)))) {
                score += 4;
            }

            return score;
        }

        function generatePremiumPreviewHtml(meta, output) {
            const candidates = [];
            const sampleCount = 4;

            for (let i = 0; i < sampleCount; i++) {
                const variantOutput = {
                    ...output,
                    variantSalt: `premium-${i + 1}-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`
                };
                const html = generatePreviewHtml(meta, variantOutput);
                const score = scorePreviewHtml(html, meta) + (Math.random() * 0.001);
                candidates.push({ html, score });
            }

            candidates.sort((a, b) => b.score - a.score);
            return candidates[0]?.html || generatePreviewHtml(meta, output);
        }

        function openPreview(id) {
            const activeId = selectActiveOrderId(id);
            const order = orders[activeId];
            const meta = getOrderMeta(activeId) || { id: String(activeId), clientName: order?.name || 'Bedrijf', title: order?.type || 'Project', description: '' };
            const output = buildOutput(meta);

            let artifact = order?.artifact || loadArtifact(activeId);
            if (!artifact) artifact = buildArtifactForOrder(activeId);

            let html = artifact ? materializeArtifactPage(artifact, 'index.html') : null;
            if (!html) html = order?.previewHtml || loadPreviewHtml(activeId);
            if (!html) {
                html = buildMode === 'premium'
                    ? generatePremiumPreviewHtml(meta, output)
                    : generatePreviewHtml(meta, output);
                orders[activeId].previewHtml = html;
                savePreviewHtml(activeId, html);
            }

            const w = window.open('about:blank', '_blank');
            if (!w) {
                alert('Pop-up geblokkeerd. Sta pop-ups toe om de preview te openen.');
                return;
            }
            try { w.opener = null; } catch (_) { /* ignore */ }
            w.document.open();
            w.document.write(html);
            w.document.close();
        }

        function executeOrder(id) {
            const activeId = selectActiveOrderId(id);
            const btn = document.getElementById(`btn-${id}`);
            const status = document.getElementById(`status-${id}`);
            const progress = document.getElementById(`progress-${id}`);
            const bar = document.getElementById(`bar-${id}`);
            const viewBtn = document.getElementById(`view-${id}`);

            if (!btn || btn.classList.contains('running') || btn.classList.contains('done')) return;

            btn.classList.add('running');

            status.textContent = 'Bezig';
            status.className = 'status-tag bezig';

            progress.classList.add('show');
            viewBtn.classList.add('show');
            viewBtn.textContent = 'Bekijk Voortgang';
            viewBtn.onclick = () => openModal(id);

            orders[id].logs = [];
            orders[id].progressPct = 0;
            orders[id].previewHtml = null;
            orders[id].artifact = null;
            orders[id].updatedAt = Date.now();
            setLastActiveOrder(activeId);

            let stepIndex = 0;
            const buildSteps = getBuildSteps();

            btn.innerHTML = buildMode === 'premium'
                ? '<svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg> AI Premium Bezig...'
                : '<svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg> AI Bezig...';

            function nextStep() {
                if (stepIndex >= buildSteps.length) {
                    btn.innerHTML = '✓ Opgeleverd';
                    btn.classList.remove('running');
                    btn.classList.add('done');

                    status.textContent = 'Klaar';
                    status.className = 'status-tag klaar';

                    bar.classList.add('green');

                    // Create and store preview
                    const bundle = buildArtifactForOrder(activeId);
                    if (!bundle) {
                        const meta = getOrderMeta(activeId);
                        if (meta) {
                            const output = buildOutput(meta);
                            const html = buildMode === 'premium'
                                ? generatePremiumPreviewHtml(meta, output)
                                : generatePreviewHtml(meta, output);
                            orders[activeId].previewHtml = html;
                            savePreviewHtml(activeId, html);
                        }
                    }

                    // Switch button to open preview
                    viewBtn.textContent = 'Open preview';
                    viewBtn.onclick = () => openPreview(activeId);
                    return;
                }

                const step = buildSteps[stepIndex];
                bar.style.width = step.pct + '%';

                for (let s = 1; s <= 5; s++) {
                    const el = document.getElementById(`step-${id}-${s}`);
                    if (!el) continue;
                    if (s < step.step) el.className = 'progress-step done';
                    else if (s === step.step) el.className = 'progress-step active';
                    else el.className = 'progress-step';
                }

                orders[id].progressPct = step.pct;
                orders[id].logs.push({ time: getTime(), msg: step.msg, highlight: step.pct === 100 });

                stepIndex++;
                setTimeout(nextStep, 1100 + Math.random() * 1400);
            }

            nextStep();
        }

        function openModal(id) {
            const modal = document.getElementById('modal');
            const log = document.getElementById('modalLog');
            const bar = document.getElementById('modalBar');
            const pct = document.getElementById('modalPct');
            const title = document.getElementById('modalTitle');
            const subtitle = document.getElementById('modalSubtitle');
            const primaryBtn = document.getElementById('modalBtn');

            currentModalId = id;

            title.textContent = orders[id].type;
            subtitle.textContent = orders[id].name;

            log.innerHTML = '';
            if (!orders[id].logs.length) {
                const div = document.createElement('div');
                div.className = 'modal-log-entry';
                div.innerHTML = '<span class="time">[--:--:--]</span> <span class="highlight">Nog geen activiteit. Start de opdracht om voortgang te zien.</span>';
                log.appendChild(div);
            } else {
                orders[id].logs.forEach(entry => {
                    const div = document.createElement('div');
                    div.className = 'modal-log-entry';
                    div.innerHTML = `<span class="time">[${entry.time}]</span> <span class="${entry.highlight ? 'success' : 'highlight'}">${entry.msg}</span>`;
                    log.appendChild(div);
                });
            }

            const pctValue = Number(orders[id].progressPct) || 0;
            bar.style.width = pctValue + '%';
            if (pctValue === 100) bar.classList.add('green');
            else bar.classList.remove('green');

            pct.textContent = pctValue + '%';

            if (pctValue === 100) {
                primaryBtn.style.display = 'block';
                primaryBtn.onclick = () => {
                    openPreview(id);
                    closeModal();
                };
            } else {
                primaryBtn.style.display = 'none';
                primaryBtn.onclick = null;
            }

            log.scrollTop = log.scrollHeight;
            modal.classList.add('show');
            modal.setAttribute('aria-hidden', 'false');
        }

        function closeModal() {
            const modal = document.getElementById('modal');
            modal.classList.remove('show');
            modal.setAttribute('aria-hidden', 'true');
        }

        // Build mode UI
        document.querySelectorAll('.mode-btn[data-build-mode]').forEach((btn) => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                setBuildMode(btn.getAttribute('data-build-mode'));
            });
        });
        setBuildMode(buildMode);

        // Bind UI
        document.querySelectorAll('.execute-btn').forEach((b) => {
            b.addEventListener('click', (e) => {
                e.stopPropagation();
                const id = Number(b.getAttribute('data-order'));
                executeOrder(id);
            });
        });

        document.querySelectorAll('.view-btn').forEach((b) => {
            b.addEventListener('click', (e) => {
                e.stopPropagation();
                const id = Number(b.getAttribute('data-order'));
                // Button switches action based on label
                if (b.textContent.trim().toLowerCase().includes('preview')) openPreview(id);
                else openModal(id);
            });
        });

        document.getElementById('modalCloseBtn').addEventListener('click', closeModal);
        document.getElementById('modalSecondaryBtn').addEventListener('click', closeModal);

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeModal();
        });

        // Click card to open modal (keeps logs accessible even when button switches to preview)
        document.querySelectorAll('.order-card').forEach((card) => {
            const id = Number(String(card.id || '').split('-')[1]);
            if (!id) return;
            card.addEventListener('click', (e) => {
                if (e.target.closest('button,a')) return;
                openModal(id);
            });
            card.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    openModal(id);
                }
            });
        });

        // Cursor (robust)
        (function initCursor() {
            const cursor = document.querySelector('.cursor');
            const cursorDot = document.querySelector('.cursor-dot');
            const hasFinePointer = window.matchMedia('(pointer: fine)').matches;
            const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            const enablePointerFx = hasFinePointer && !prefersReducedMotion;

            function disable() {
                document.body.style.cursor = 'auto';
                if (cursor) cursor.style.display = 'none';
                if (cursorDot) cursorDot.style.display = 'none';
            }

            if (!cursor || !cursorDot || !enablePointerFx) {
                disable();
                return;
            }

            let mouseX = 0, mouseY = 0, cursorX = 0, cursorY = 0, dotX = 0, dotY = 0;
            document.addEventListener('mousemove', (e) => { mouseX = e.clientX; mouseY = e.clientY; });

            function animateCursor() {
                cursorX += (mouseX - cursorX) * 0.15;
                cursorY += (mouseY - cursorY) * 0.15;
                cursor.style.left = cursorX + 'px';
                cursor.style.top = cursorY + 'px';
                dotX += (mouseX - dotX) * 0.5;
                dotY += (mouseY - dotY) * 0.5;
                cursorDot.style.left = dotX + 'px';
                cursorDot.style.top = dotY + 'px';
                requestAnimationFrame(animateCursor);
            }
            animateCursor();

            document.addEventListener('mouseover', (e) => {
                if (e.target.closest('.magnetic')) cursor.classList.add('hover');
            });
            document.addEventListener('mouseout', (e) => {
                if (e.target.closest('.magnetic')) cursor.classList.remove('hover');
            });

            window.addEventListener('error', disable);
        })();
    </script>
</body>
</html>
